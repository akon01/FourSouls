{"version":3,"sources":["components/GComposite.ts"],"names":[],"mappings":"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","file":"../../components/GComposite.js","sourcesContent":["import { Mode, Express } from '../types';\r\nimport { NullNode } from './NullComponent';\r\nimport { IComponent } from './IComponent';\r\nimport { isFunction, isString } from '../utils';\r\nimport { GComponent } from './GComponent';\r\n\r\n/**\r\n * generics composite\r\n *\r\n * @export\r\n * @class GComposite\r\n * @implements {GComponent<T>}\r\n * @template T\r\n */\r\nexport class GComposite<T extends IComponent> implements GComponent<T> {\r\n    parent: T;\r\n    protected children: T[];\r\n    constructor(public name: string) {\r\n        this.children = [];\r\n    }\r\n\r\n    add(node: T): this {\r\n        node.parent = this as IComponent;\r\n        this.children.push(node);\r\n        return this;\r\n\r\n    }\r\n\r\n    remove(node?: string | T): this {\r\n        let component: IComponent;\r\n        if (isString(node)) {\r\n            component = this.find(cmp => isString(node) ? cmp.name === node : cmp.equals(node));\r\n        } else if (node) {\r\n            component = node;\r\n        } else {\r\n            component = this as IComponent;\r\n        }\r\n\r\n        if (!component.parent) {\r\n            return this;\r\n        } else if (this.equals(component.parent as T)) {\r\n            this.children.splice(this.children.indexOf(component as T), 1);\r\n            component.parent = null;\r\n            return this;\r\n        } else {\r\n            component.parent.remove(component);\r\n            return null;\r\n        }\r\n    }\r\n\r\n    find(express: T | Express<T, boolean>, mode?: Mode): T {\r\n        let component: any;\r\n        this.each(item => {\r\n            if (component) {\r\n                return false;\r\n            }\r\n            let isFinded = isFunction(express) ? express(item) : express === (item);\r\n            if (isFinded) {\r\n                component = item;\r\n                return false;\r\n            }\r\n            return true;\r\n        }, mode);\r\n        return (component || this.empty()) as T;\r\n    }\r\n\r\n    filter(express: Express<T, void | boolean>, mode?: Mode): T[] {\r\n        let nodes: IComponent[] = [];\r\n        this.each(item => {\r\n            if (express(item)) {\r\n                nodes.push(item);\r\n            }\r\n        }, mode);\r\n        return nodes as T[];\r\n    }\r\n\r\n    each(iterate: Express<T, boolean | void>, mode?: Mode) {\r\n        mode = mode || Mode.traverse;\r\n        let r;\r\n        switch (mode) {\r\n            case Mode.route:\r\n                r = this.routeUp(iterate);\r\n                break;\r\n            case Mode.children:\r\n                r = this.eachChildren(iterate);\r\n                break;\r\n\r\n            case Mode.traverse:\r\n                r = this.trans(iterate);\r\n                break;\r\n            case Mode.traverseLast:\r\n                r = this.transAfter(iterate);\r\n                break;\r\n            default:\r\n                r = this.trans(iterate);\r\n                break;\r\n        }\r\n        return r;\r\n    }\r\n\r\n    eachChildren(iterate: Express<T, void | boolean>) {\r\n        (this.children || []).forEach(item => {\r\n            return iterate(item as T);\r\n        });\r\n    }\r\n\r\n    /**\r\n     *do express work in routing.\r\n     *\r\n     *@param {Express<T, void | boolean>} express\r\n     *\r\n     *@memberOf IComponent\r\n     */\r\n    routeUp(iterate: Express<T, void | boolean>) {\r\n        let curr = this as IComponent;\r\n        if (iterate(curr as T) === false) {\r\n            return false;\r\n        };\r\n        if (this.parent && this.parent.routeUp) {\r\n            return this.parent.routeUp(iterate);\r\n        }\r\n    }\r\n\r\n    /**\r\n     *translate all sub context to do express work.\r\n     *\r\n     *@param {Express<T, void | boolean>} express\r\n     *\r\n     *@memberOf IComponent\r\n     */\r\n    trans(express: Express<T, void | boolean>) {\r\n        let curr = this as IComponent;\r\n        if (express(curr as T) === false) {\r\n            return false;\r\n        }\r\n        let children = this.children || [];\r\n        for (let i = 0; i < children.length; i++) {\r\n            let result = children[i].trans(express);\r\n            if (result === false) {\r\n                return result;\r\n            }\r\n        }\r\n        return true;\r\n    }\r\n\r\n    transAfter(express: Express<T, void | boolean>) {\r\n        let children = this.children || []\r\n        for (let i = 0; i < children.length; i++) {\r\n            let result = children[i].transAfter(express);\r\n            if (result === false) {\r\n                return false;\r\n            }\r\n        }\r\n        let curr = this as IComponent;\r\n        if (express(curr as T) === false) {\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n\r\n    equals(node: T): boolean {\r\n        return this === node as IComponent;\r\n    }\r\n\r\n    empty(): T {\r\n        return NullNode as T;\r\n    }\r\n\r\n    isEmpty(): boolean {\r\n        return this.equals(this.empty() as T);\r\n    }\r\n\n                        static getClassAnnations():any  {\n                            return {\"name\":\"GComposite\",\"params\":{\"constructor\":[\"name\"],\"add\":[\"node\"],\"remove\":[\"node\"],\"find\":[\"express\",\"mode\"],\"filter\":[\"express\",\"mode\"],\"each\":[\"iterate\",\"mode\"],\"eachChildren\":[\"iterate\"],\"routeUp\":[\"iterate\"],\"trans\":[\"express\"],\"transAfter\":[\"express\"],\"equals\":[\"node\"],\"empty\":[],\"isEmpty\":[]}};\n                        }\n                   }\r\n"]}