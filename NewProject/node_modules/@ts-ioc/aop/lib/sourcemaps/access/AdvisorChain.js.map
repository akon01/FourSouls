{"version":3,"sources":["access/AdvisorChain.ts"],"names":[],"mappings":";;;AAAA,qCAAqH;AACrH,4CAA0C;AAC1C,iDAAmE;AACnE,2DAA8D;AAC9D,2DAA0D;AAE1D;;;;;;GAMG;AAGH;IAOI,sBAAsB,SAAoB;QAApB,cAAS,GAAT,SAAS,CAAW;QACtC,IAAI,CAAC,OAAO,GAAG,EAAE,CAAC;IACtB,CAAC;IAED;;;;;OAKG;IACH,2BAAI,GAAJ,UAAK,MAA+B;QAChC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;IAC9B,CAAC;IAED;;;;;OAKG;IACH,oCAAa,GAAb;QACI,OAAO,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,sBAAe,EAAE,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC;IACrE,CAAC;IAED;;;;OAIG;IACH,8BAAO,GAAP;;QACI,IAAI,KAAK,GAAG,IAAI,CAAC,aAAa,EAAE,CAAC,SAAS,CAAC,IAAI,CAAC,SAAS,CAAC,SAAS,CAAC,CAAC;QACrE,CAAA,KAAA,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,2CAAsB,EAAE,KAAK,CAAC,CAAA,CAC5C,UAAU,YAAC,IAAI,CAAC,SAAS,SAAK,IAAI,CAAC,OAAO,GAAE;IACrD,CAAC;IAG0B,8BAAiB,GAAxB;QACI,OAAO,EAAC,MAAM,EAAC,cAAc,EAAC,QAAQ,EAAC,EAAC,aAAa,EAAC,CAAC,WAAW,CAAC,EAAC,MAAM,EAAC,CAAC,QAAQ,CAAC,EAAC,eAAe,EAAC,EAAE,EAAC,SAAS,EAAC,EAAE,EAAC,EAAC,CAAC;IAC5H,CAAC;IA1CrB;QADC,aAAM,CAAC,qBAAc,CAAC;;mDACD;IAHb,YAAY;QAFxB,2BAAY,EAAE;QACd,iBAAU,CAAC,iCAAiB,CAAC;iDAQO,sBAAS;OAPjC,YAAY,CA8CL;IAAD,mBAAC;CA9CpB,AA8CoB,IAAA;AA9CP,oCAAY","file":"../../access/AdvisorChain.js","sourcesContent":["import { IContainer, Injectable, Inject, IRecognizer, Express, ContainerToken, RecognizerToken } from '@ts-ioc/core';\r\nimport { Joinpoint } from '../joinpoints';\r\nimport { IAdvisorChain, AdvisorChainToken } from './IAdvisorChain';\r\nimport { AdvisorProceedingToken } from './IAdvisorProceeding';\r\nimport { NonePointcut } from '../decorators/NonePointcut';\r\n\r\n/**\r\n * advisor chain.\r\n *\r\n * @export\r\n * @class AdvisorChain\r\n * @implements {IAdvisorChain}\r\n */\r\n@NonePointcut()\r\n@Injectable(AdvisorChainToken)\r\nexport class AdvisorChain implements IAdvisorChain {\r\n\r\n    @Inject(ContainerToken)\r\n    container: IContainer;\r\n\r\n    protected actions: Express<Joinpoint, any>[];\r\n\r\n    constructor(protected joinPoint: Joinpoint) {\r\n        this.actions = [];\r\n    }\r\n\r\n    /**\r\n     * register next action.\r\n     *\r\n     * @param {Express<Joinpoint, any>} action\r\n     * @memberof AdvisorChain\r\n     */\r\n    next(action: Express<Joinpoint, any>) {\r\n        this.actions.push(action);\r\n    }\r\n\r\n    /**\r\n     * get recognizer of this advisor.\r\n     *\r\n     * @returns {IRecognizer}\r\n     * @memberof AdvisorChain\r\n     */\r\n    getRecognizer(): IRecognizer {\r\n        return this.container.get(RecognizerToken, this.joinPoint.state);\r\n    }\r\n\r\n    /**\r\n     * process the advices.\r\n     *\r\n     * @memberof AdvisorChain\r\n     */\r\n    process(): void {\r\n        let alias = this.getRecognizer().recognize(this.joinPoint.returning);\r\n        this.container.get(AdvisorProceedingToken, alias)\r\n            .proceeding(this.joinPoint, ...this.actions);\r\n    }\r\n\r\n\n                        static getClassAnnations():any  {\n                            return {\"name\":\"AdvisorChain\",\"params\":{\"constructor\":[\"joinPoint\"],\"next\":[\"action\"],\"getRecognizer\":[],\"process\":[]}};\n                        }\n                   }\r\n"]}