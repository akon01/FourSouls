{"version":3,"sources":["access/AsyncPromiseProceeding.ts"],"names":[],"mappings":";;;AAAA,uCAAkD;AAClD,6DAAkF;AAElF,mDAAgD;AAChD,6DAA0D;AAI1D,IAAa,sBAAsB,GAAnC,MAAa,sBAAsB;IAE/B;IAEA,CAAC;IAED,UAAU,CAAC,SAAoB,EAAE,GAAG,OAAkC;QAClE,IAAI,SAAS,CAAC,SAAS,EAAE;YACrB,OAAO,CAAC,OAAO,CAAC,CAAC,MAAM,CAAC,EAAE;gBACtB,SAAS,CAAC,SAAS,GAAG,SAAS,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC,GAAG,EAAE,EAAE;oBACnD,SAAS,CAAC,cAAc,GAAG,GAAG,CAAC;oBAC/B,OAAO,OAAO,CAAC,OAAO,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC;yBACpC,IAAI,CAAC,GAAG,EAAE;wBACP,OAAO,SAAS,CAAC,cAAc,CAAC;oBACpC,CAAC,CAAC,CAAC;gBACX,CAAC,CAAC,CAAC;YACP,CAAC,CAAC,CAAC,CAAC;SACP;IACL,CAAC;IAEmB,MAAM,CAAC,iBAAiB;QACpB,OAAO,EAAC,MAAM,EAAC,wBAAwB,EAAC,QAAQ,EAAC,EAAC,aAAa,EAAC,EAAE,EAAC,YAAY,EAAC,CAAC,WAAW,EAAC,SAAS,CAAC,EAAC,EAAC,CAAC;IAC9G,CAAC;CACL,CAAA;AAvBP,sBAAsB;IAFlC,2BAAY,EAAE;IACd,gBAAS,CAAC,2CAAsB,EAAE,6BAAa,CAAC,OAAO,CAAC;;GAC5C,sBAAsB,CAuBf;AAvBP,wDAAsB","file":"../../access/AsyncPromiseProceeding.js","sourcesContent":["import { Express, Singleton } from '@ts-ioc/core';\r\nimport { IAdvisorProceeding, AdvisorProceedingToken } from './IAdvisorProceeding';\r\nimport { Joinpoint } from '../joinpoints';\r\nimport { ReturningType } from './ReturningType';\r\nimport { NonePointcut } from '../decorators/NonePointcut';\r\n\r\n@NonePointcut()\r\n@Singleton(AdvisorProceedingToken, ReturningType.promise)\r\nexport class AsyncPromiseProceeding implements IAdvisorProceeding {\r\n\r\n    constructor() {\r\n\r\n    }\r\n\r\n    proceeding(joinPoint: Joinpoint, ...actions: Express<Joinpoint, any>[]) {\r\n        if (joinPoint.returning) {\r\n            actions.forEach((action => {\r\n                joinPoint.returning = joinPoint.returning.then((val) => {\r\n                    joinPoint.returningValue = val;\r\n                    return Promise.resolve(action(joinPoint))\r\n                        .then(() => {\r\n                            return joinPoint.returningValue;\r\n                        });\r\n                });\r\n            }));\r\n        }\r\n    }\r\n\n                        static getClassAnnations():any  {\n                            return {\"name\":\"AsyncPromiseProceeding\",\"params\":{\"constructor\":[],\"proceeding\":[\"joinPoint\",\"actions\"]}};\n                        }\n                   }\r\n"]}