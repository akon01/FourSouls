!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("tslib"),require("reflect-metadata")):"function"==typeof define&&define.amd?define(["tslib","reflect-metadata"],t):(e.core=e.core||{},e.core.umd=e.core.umd||{},e.core.umd.js=t(e.tslib,e.Reflect))}(this,function(l,e){"use strict";function n(){throw new Error("Dynamic requires are not currently supported by rollup-plugin-commonjs")}function t(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function r(e,t){return e(t={exports:{}},t.exports),t.exports}l=l&&l.hasOwnProperty("default")?l.default:l,e=e&&e.hasOwnProperty("default")?e.default:e;var v=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){this.map=new Map}return Object.defineProperty(e.prototype,"size",{get:function(){return this.map.size},enumerable:!0,configurable:!0}),e.prototype.clear=function(){this.map.clear()},e.prototype.delete=function(e){return this.map.delete(e)},e.prototype.get=function(e){return this.map.get(e)},e.prototype.has=function(e){return this.map.has(e)},e.prototype.set=function(e,t){return this.map.set(e,t),this},e.prototype.keys=function(){return Array.from(this.map.keys())},e.prototype.values=function(){return Array.from(this.map.values())},e.getClassAnnations=function(){return{name:"MapBase",params:{constructor:[],clear:[],delete:["key"],get:["key"],has:["key"],set:["key","value"],keys:[],values:[]}}},e}(),n=function(e){function t(){return e.call(this)||this}return l.__extends(t,e),t.prototype.forEach=function(e,t){this.map.forEach(e,t)},t.getClassAnnations=function(){return{name:"MapSet",params:{constructor:[],forEach:["callbackfn","thisArg"]}}},t}(t.MapBase=r);t.MapSet=n,function(e){function o(e){return c.isObject(e)&&c.isFunction(Object.keys)?Object.keys(e):[]}function t(r,n){c.isArray(r)?r.some(function(e,t){return!1===n(e,t)}):c.isObject(r)&&o(r).some(function(e,t){return!1===n(r[e],e)})}function n(e){return c.isFunction(e.getClassAnnations)?e.getClassAnnations():e.classAnnations}function a(e){return c.isNullOrUndefined(e)?null:c.isClass(e)?e:e.constructor||e.prototype.constructor}function r(e){var t=Reflect.getPrototypeOf(e.prototype);return c.isClass(t)?t:t.constructor}function i(e,t){for(;c.isClassType(e)&&e!==Object&&!1!==t(e);)e=r(e)}e.assert=function(e,t){if(c.isNullOrUndefined(e))throw new Error(c.isFunction(t)?t(e):t)},e.assertExp=function(e,t){if(!(c.isFunction(e)?e():e))throw new Error(c.isFunction(t)?t():t)},e.keys=o,e.values=function(t){return c.isObject(t)?c.isFunction(Object.values)?Object.values(t):o(t).map(function(e){return t[e]}):[]},e.assign=function(e,t,r,n){return n&&n.length?(n.unshift(r||{}),n.unshift(t||{}),Object.assign.apply(Object,[e].concat(n))):r?Object.assign(e,t||{},r):Object.assign(e,t||{})},e.omit=function(t){for(var r=[],e=1;e<arguments.length;e++)r[e-1]=arguments[e];if(c.isObject(t)){var n={};return o(t).forEach(function(e){r.indexOf(e)<0&&(n[e]=t[e])}),n}return t},e.hasField=function(e){return 0<o(e).length},e.forIn=t,e.find=function(e,r){var n;t(e,function(e,t){return!!n||!r(e,t)||(n=e,!1)})},e.first=function(e){return c.isArray(e)&&e.length?e[0]:null},e.last=function(e){return c.isArray(e)&&e.length?e[e.length-1]:null},e.getClassAnnations=n,e.hasClassAnnations=function(e){return!!c.isFunction(e.getClassAnnations)||e.classAnnations&&c.isString(e.classAnnations.name)&&0<e.classAnnations.name.length},e.getClass=a,e.getClassName=function(e){var t=c.isFunction(e)?e:a(e);if(!c.isFunction(t))return"";if(/^[a-z]$/.test(t.name)){var r=n(t);return r?r.name:t.name}return t.name},e.getParentClass=r,e.getClassChain=function(e){var t=[];return i(e,function(e){t.push(e)}),t},e.forInClassChain=i,e.isExtendsClass=function(e,t){var r=!1;return c.isClassType(e)&&i(e,function(e){return!(r=c.isClassType(t)?e===t:t(e))}),r}}(t.lang||(t.lang={}))});t(v);v.MapBase,v.MapSet,v.lang;var c=r(function(e,t){function r(e){return!!e&&"function"==typeof e}function n(e){if(!r(e))return!1;if(e.prototype){if(!e.name||"Object"===e.name)return!1;var t=e;if(/^[a-z]$/.test(t.name))return!!v.lang.hasClassAnnations(t);if(v.lang.hasClassAnnations(t))return!0;if(!/^[A-Z@]/.test(e.name))return!1;if(!o()&&/MSIE [6-9]/.test(navigator.userAgent))return!0;try{return e.arguments&&e.caller,!1}catch(e){return!0}}return!1}function o(){return"undefined"!=typeof process&&void 0!==process.versions.node}function a(e){return!!e&&!!(c(e)||d(e)||n(e)||e instanceof y.Registration)}function i(e){return!!e&&!(!e.constructor||"Object"!==e.constructor.name)}function s(e){for(var r=[],t=1;t<arguments.length;t++)r[t-1]=arguments[t];return!!i(e)&&(!r.length||v.lang.keys(e).some(function(t){return r.some(function(e){return c(e)?e===t:0<e.indexOf(t)})}))}function c(e){return"string"==typeof e}function u(e){return void 0===e||void 0===e}function p(e){return null===e}function l(e){return p(e)||u(e)}function f(e){if(l(e))return!1;var t=typeof e;return"object"===t||"function"===t}function d(e){return"symbol"==typeof e||f(e)&&/^Symbol\(/.test(e.toString())}function h(e){return!!r(e)&&(e===Object||e===Boolean||e===String||e===Number||e===Date)}Object.defineProperty(t,"__esModule",{value:!0}),t.isFunction=r,t.isAbstractClass=function(e){return n(e)&&Reflect.hasOwnMetadata("@Abstract",e)},t.isClass=function(e){return n(e)&&!Reflect.hasOwnMetadata("@Abstract",e)},t.isClassType=function(e){return n(e)},t.isNodejsEnv=o,t.isToken=a,t.isPromise=function(e){if(!e)return!1;var t=e.constructor||e.prototype.constructor;return!(!t||"Promise"!==t.name)},t.isObservable=function(e){if(!e&&!f(e))return!1;var t=e.constructor||e.prototype.constructor;return!(!t||"Observable"!==t.name)},t.isBaseObject=i,t.isMetadataObject=s,t.isRefTarget=function(e){return!0===i(e)&&a(e.target)},t.isClassMetadata=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return s.apply(void 0,[e].concat(t.concat(["singleton","provide","alias","type"])))},t.isProvideMetadata=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return s.apply(void 0,[e].concat(t.concat(["type","provider"])))},t.isString=c,t.isBoolean=function(e){return"boolean"==typeof e||!0===e||!1===e},t.isNumber=function(e){return"number"==typeof e},t.isUndefined=u,t.isNull=p,t.isNullOrUndefined=l,t.isArray=function(e){return Array.isArray(e)},t.isObject=f,t.isTypeObject=function(e){return!l(e)&&"object"==typeof e&&!h(v.lang.getClass(e))},t.isDate=function(e){return f(e)&&e instanceof Date},t.isSymbol=d,t.isRegExp=function(e){return e&&e instanceof RegExp},t.isBaseType=h});t(c);c.isFunction,c.isAbstractClass,c.isClass,c.isClassType,c.isNodejsEnv,c.isToken,c.isPromise,c.isObservable,c.isBaseObject,c.isMetadataObject,c.isRefTarget,c.isClassMetadata,c.isProvideMetadata,c.isString,c.isBoolean,c.isNumber,c.isUndefined,c.isNull,c.isNullOrUndefined,c.isArray,c.isObject,c.isTypeObject,c.isDate,c.isSymbol,c.isRegExp,c.isBaseType;var o=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function r(){var r=this;this.promise=new Promise(function(e,t){r.resolve=e,r.reject=t})}return r.create=function(e){var t=new r;return e&&(t.promise=t.promise.then(e)),t},r.getClassAnnations=function(){return{name:"Defer",params:{create:["then"],constructor:[]}}},r}();t.Defer=s,function(e){function o(e,n,t){var o=new s,a=Promise.resolve(t),i=e?e.length:0;return i?(e.forEach(function(t,r){a=a.then(function(e){return c.isFunction(t)?t(e):t}).then(function(e){return!1===n(e)?(o.resolve("complete"),Promise.reject("complete")):r===i-1?(o.resolve("complete"),Promise.reject("complete")):e})}),a.catch(function(e){return e})):o.reject("array empty."),o.promise}e.defer=function(e){return s.create(e)},e.forEach=o,e.step=function(e){var r=Promise.resolve(null);return e.forEach(function(t){r=r.then(function(e){return c.isFunction(t)?t(e):t})}),r},e.find=function(e,t,r){var n=new s;return o(e,function(e){return!t(e)||(n.resolve(e),!1)},r).then(function(){return n.resolve(null)}).catch(function(){n.resolve(null)}),n.promise},e.runInChain=function(n,o,a){var i=-1;return function e(t){if(t<=i)return Promise.reject("next called mutiple times");var r=(i=t)<n.length?n[t]:null;if(t===n.length&&(r=a),!r)return Promise.resolve();try{return Promise.resolve(r(o,e.bind(null,t+1)))}catch(e){return Promise.reject(e)}}(0)}}(t.PromiseUtil||(t.PromiseUtil={}))});t(o);o.Defer,o.PromiseUtil;var P=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),l.__exportStar(c,t),l.__exportStar(v,t),l.__exportStar(o,t)});t(P);var y=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.isRegistrationClass=function(e){return!!P.isClass(e)&&!0===e.isIocRegClass};var r=function(){function r(e,t){this.type="",this.init(e,t)}return r.prototype.init=function(e,t){e instanceof r?t?(this.classType=e.toString(),this.desc=t):(this.classType=e.getProvide(),this.desc=e.getDesc()):(this.classType=e,this.desc=t)},r.prototype.getProvide=function(){return this.classType},r.prototype.getClass=function(){return P.isClass(this.classType)?this.classType:null},r.prototype.getDesc=function(){return this.desc},r.prototype.toString=function(){return this.format(this)},r.prototype.format=function(e){if(e instanceof r){var t="";return P.isFunction(e.classType)?t="{"+P.lang.getClassName(e.classType)+"}":e.classType&&(t=e.classType.toString()),[e.type,t,e.desc].filter(function(e){return e}).join("_")}return P.isFunction(e)?"{"+P.lang.getClassName(e)+"}":e?e.toString():""},r.getClassAnnations=function(){return{name:"Registration",params:{constructor:["provideType","desc"],init:["provideType","desc"],getProvide:[],getClass:[],getDesc:[],toString:[],format:["reg"]}}},r.isIocRegClass=!0,r}();t.Registration=r});t(y);y.isRegistrationClass,y.Registration;var a=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(t){function e(e){return t.call(this,e,"")||this}return l.__extends(e,t),e.getClassAnnations=function(){return{name:"InjectToken",params:{constructor:["desc"]}}},e}(y.Registration);t.InjectToken=r});t(a);a.InjectToken;var h=r(function(e,t){var r;Object.defineProperty(t,"__esModule",{value:!0}),t.ContainerToken=new a.InjectToken("DI_IContainer"),(r=t.ResoveWay||(t.ResoveWay={}))[r.current=1]="current",r[r.traverse=2]="traverse",r[r.bubble=4]="bubble",r[r.nodes=3]="nodes",r[r.routeup=5]="routeup",r[r.all=7]="all"});t(h);h.ContainerToken,h.ResoveWay;var d=r(function(e,t){var r,n,o;Object.defineProperty(t,"__esModule",{value:!0}),(r=t.RefTagLevel||(t.RefTagLevel={}))[r.self=1]="self",r[r.providers=2]="providers",r[r.selfProviders=3]="selfProviders",r[r.chain=4]="chain",r[r.selfChain=5]="selfChain",r[r.chainProviders=6]="chainProviders",r[r.all=7]="all",(n=t.IocState||(t.IocState={})).design="design",n.runtime="runtime",(o=t.Mode||(t.Mode={}))[o.route=1]="route",o[o.children=2]="children",o[o.traverse=3]="traverse",o[o.traverseLast=4]="traverseLast"});t(d);d.RefTagLevel,d.IocState,d.Mode;var i=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.MethodAccessorToken=new a.InjectToken("DI_IMethodAccessor")});t(i);i.MethodAccessorToken;var s=r(function(e,r){Object.defineProperty(r,"__esModule",{value:!0});var t=function(){function e(){}return e.prototype.isEmpty=function(){return!0},e.prototype.add=function(e){return this},e.prototype.remove=function(e){return this},e.prototype.find=function(e,t){return r.NullNode},e.prototype.filter=function(e,t){return[]},e.prototype.each=function(e,t){},e.prototype.trans=function(e){},e.prototype.transAfter=function(e){},e.prototype.routeUp=function(e){},e.prototype.equals=function(e){return e===r.NullNode},e.prototype.empty=function(){return r.NullNode},e.getClassAnnations=function(){return{name:"NullComponent",params:{isEmpty:[],add:["action"],remove:["action"],find:["express","mode"],filter:["express","mode"],each:["express","mode"],trans:["express"],transAfter:["express"],routeUp:["express"],equals:["node"],empty:[]}}},e}();r.NullComponent=t,r.NullNode=new t});t(s);s.NullComponent,s.NullNode;var u=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this.name=e,this.children=[]}return e.prototype.add=function(e){return(e.parent=this).children.push(e),this},e.prototype.remove=function(t){var e;return(e=P.isString(t)?this.find(function(e){return P.isString(t)?e.name===t:e.equals(t)}):t||this).parent?this.equals(e.parent)?(this.children.splice(this.children.indexOf(e),1),e.parent=null,this):(e.parent.remove(e),null):this},e.prototype.find=function(t,e){var r;return this.each(function(e){return!r&&(!(P.isFunction(t)?t(e):t===e)||(r=e,!1))},e),r||this.empty()},e.prototype.filter=function(t,e){var r=[];return this.each(function(e){t(e)&&r.push(e)},e),r},e.prototype.each=function(e,t){var r;switch(t=t||d.Mode.traverse){case d.Mode.route:r=this.routeUp(e);break;case d.Mode.children:r=this.eachChildren(e);break;case d.Mode.traverse:r=this.trans(e);break;case d.Mode.traverseLast:r=this.transAfter(e);break;default:r=this.trans(e)}return r},e.prototype.eachChildren=function(t){(this.children||[]).forEach(function(e){return t(e)})},e.prototype.routeUp=function(e){return!1!==e(this)&&(this.parent&&this.parent.routeUp?this.parent.routeUp(e):void 0)},e.prototype.trans=function(e){if(!1===e(this))return!1;for(var t=this.children||[],r=0;r<t.length;r++){var n=t[r].trans(e);if(!1===n)return n}return!0},e.prototype.transAfter=function(e){for(var t=this.children||[],r=0;r<t.length;r++){if(!1===t[r].transAfter(e))return!1}return!1!==e(this)},e.prototype.equals=function(e){return this===e},e.prototype.empty=function(){return s.NullNode},e.prototype.isEmpty=function(){return this.equals(this.empty())},e.getClassAnnations=function(){return{name:"GComposite",params:{constructor:["name"],add:["node"],remove:["node"],find:["express","mode"],filter:["express","mode"],each:["iterate","mode"],eachChildren:["iterate"],routeUp:["iterate"],trans:["express"],transAfter:["express"],equals:["node"],empty:[],isEmpty:[]}}},e}();t.GComposite=r});t(u);u.GComposite;var p=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(r){function e(e){return r.call(this,e)||this}return l.__extends(e,r),e.prototype.find=function(e,t){return r.prototype.find.call(this,e,t)},e.prototype.filter=function(e,t){return r.prototype.filter.call(this,e,t)},e.prototype.each=function(e,t){return r.prototype.each.call(this,e,t)},e.prototype.eachChildren=function(e){r.prototype.eachChildren.call(this,e)},e.getClassAnnations=function(){return{name:"Composite",params:{constructor:["name"],find:["express","mode"],filter:["express","mode"],each:["express","mode"],eachChildren:["express"]}}},e}(u.GComposite);t.Composite=r});t(p);p.Composite;var f=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),l.__exportStar(p,t),l.__exportStar(u,t),l.__exportStar(s,t)});t(f);var g=r(function(e,r){Object.defineProperty(r,"__esModule",{value:!0});var t=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return l.__extends(t,e),t.prototype.insert=function(e,t){return this},t.prototype.execute=function(e,t,r){},t.prototype.empty=function(){return r.NullAction},t.getClassAnnations=function(){return{name:"NullActionClass",params:{insert:["action","index"],execute:["container","data","name"],empty:[]}}},t}(f.NullComponent);r.NullAction=new t});t(g);g.NullAction;var m=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(r){function o(e){var t=r.call(this,e)||this;return t.children=[],t}return l.__extends(o,r),o.prototype.insert=function(e,t){return e.parent=this,t<0?t=0:t>=this.children.length&&(t=this.children.length-1),this.children.splice(t,0,e),this},o.prototype.execute=function(t,r,n){n?this.find(function(e){return e.name===n}).execute(t,r):this.trans(function(e){e instanceof o&&e.working(t,r)})},o.prototype.empty=function(){return g.NullAction},o.prototype.working=function(e,t){},o.getClassAnnations=function(){return{name:"ActionComposite",params:{constructor:["name"],insert:["node","index"],execute:["container","data","name"],empty:[],working:["container","data"]}}},o}(f.GComposite);t.ActionComposite=r});t(m);m.ActionComposite;var _=r(function(e,t){var r;Object.defineProperty(t,"__esModule",{value:!0}),(r=t.LifeState||(t.LifeState={})).beforeCreateArgs="beforeCreateArgs",r.beforeConstructor="beforeConstructor",r.afterConstructor="afterConstructor",r.onInit="onInit",r.AfterInit="AfterInit"});t(_);_.LifeState;var C=r(function(e,t){var r;Object.defineProperty(t,"__esModule",{value:!0}),(r=t.CoreActions||(t.CoreActions={})).bindParameterType="bindParameterType",r.bindPropertyType="bindPropertyType",r.injectProperty="injectProperty",r.bindProvider="bindProvider",r.bindParameterProviders="bindParameterProviders",r.cache="cache",r.componentBeforeInit="componentBeforeInit",r.componentInit="componentInit",r.componentAfterInit="componentAfterInit",r.singletion="singletion",r.autorun="autorun",r.methodAutorun="methodAutorun"});t(C);C.CoreActions;var T=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this.args=e,this.idx=-1,this.metadata=null}return e.prototype.isCompeted=function(){return this.idx>=this.args.length},e.prototype.end=function(){this.idx=this.args.length},e.prototype.next=function(e){if(this.idx++,this.isCompeted())return null;var t=this.args[this.idx];e.isMetadata&&e.isMetadata(t)?(this.metadata=P.lang.assign(this.metadata||{},t),this.end()):e.match(t)?(this.metadata=this.metadata||{},e.setMetadata(this.metadata,t)):(P.isMetadataObject(t)&&(this.metadata=P.lang.assign(this.metadata||{},t)),this.end())},e.prototype.getArgs=function(){return this.args},e.prototype.getMetadata=function(){return this.metadata},e.getClassAnnations=function(){return{name:"ArgsIterator",params:{constructor:["args"],isCompeted:[],end:[],next:["express"],getArgs:[],getMetadata:[]}}},e}();t.ArgsIterator=r});t(T);T.ArgsIterator;var M=r(function(e,t){var r;Object.defineProperty(t,"__esModule",{value:!0}),(r=t.DecoratorType||(t.DecoratorType={}))[r.Class=1]="Class",r[r.Parameter=2]="Parameter",r[r.Property=4]="Property",r[r.Method=8]="Method",r[r.All=15]="All"});t(M);M.DecoratorType;var A=r(function(e,i){function s(e,t,r,n,o){var a;switch(r.length){case 1:if(a=r[0],P.isClass(a)||P.isAbstractClass(a))return function(e,t,r,n,o){var a=c(t,r).slice(0),i=n||{};i.type||(i.type=r);i.decorator=e,o&&o(i);a.unshift(i),m(r),Reflect.defineMetadata(t,a,r)}(e,t,a,n,o),a;break;case 2:h(e,t,a=r[0],r[1],n,o);break;case 3:if(P.isNumber(r[2])){!function(e,t,r,n,o,a,i){var s=y(t,r,n).slice(0);for(;s.length<=o;)s.push(null);s[o]=s[o]||[];var c=a||{};if(!c.type){var u=Reflect.getOwnMetadata("design:type",r,n);u||(u=Reflect.getOwnMetadata("design:type",r.constructor,n)),c.type=u}c.propertyKey=n,c.decorator=e,c.index=o,i&&i(c);s[o].unshift(c),Reflect.defineMetadata(t+v,s,r,n)}(e,t,a=r[0],r[1],r[2],n,o)}else{if(!P.isUndefined(r[2])){a=r[0];var i=r[1],s=r[2];return function(e,t,r,n,o,a,i){var s=P.lang.assign({},p(t,r));s[n]=s[n]||[];var c=a||{};c.decorator=e,c.propertyKey=n,i&&i(c);s[n].unshift(c),Reflect.defineMetadata(t+u,s,r.constructor)}(e,t,a,i,0,n,o),s}h(e,t,a=r[0],r[1],n,o)}break;default:throw new Error("Invalid @"+e+" Decorator declaration.")}}function c(e,t){var r=Reflect.getOwnMetadata(P.isFunction(e)?e.toString():e,t);return r=P.isArray(r)?r:[]}Object.defineProperty(i,"__esModule",{value:!0}),i.ParamerterName="paramerter_names",i.createDecorator=function(n,o,a){var i="@"+n,e=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=null;return e.length<1?function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return s(n,i,e,r,a)}:(r=function(e,t){var r=null;if(e.length)if(t){var n=new T.ArgsIterator(e);t(n),r=n.getMetadata()}else 1===e.length&&P.isMetadataObject(e[0])&&(r=e[0]);return r}(e,o))?function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return s(n,i,e,r,a)}:1!==e.length||P.isClass(e[0])?s(n,i,e,r,a):function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return s(n,i,e,r,a)}};return e.toString=function(){return i},e.decoratorType=M.DecoratorType.All,e},i.getClassDecorators=function(e){return Reflect.getOwnMetadataKeys(e).filter(function(e){return!(!e||!P.isString(e)||!/^@/.test(e)||/__\w+$/.test(e))})},i.getMethodDecorators=function(e){return Reflect.getMetadataKeys(e).filter(function(e){return e&&P.isString(e)&&/^@\S+__method$/.test(e)}).map(function(e){return e.replace(/__method$/gi,"")})},i.getPropDecorators=function(e){return Reflect.getMetadataKeys(e).filter(function(e){return e&&P.isString(e)&&/^@\S+__props$/.test(e)}).map(function(e){return e.replace(/__props$/gi,"")})},i.getParamDecorators=function(e,t){return(t&&"constructor"!==t?Reflect.getMetadataKeys(e,t):Reflect.getOwnMetadataKeys(P.lang.getClass(e))||[]).filter(function(e){return e&&P.isString(e)&&/^@\S+__params$/.test(e)}).map(function(e){return e.replace(/__params$/gi,"")})},i.getTypeMetadata=function(e,t){var r=Reflect.getOwnMetadata(P.isFunction(e)?e.toString():e,t);return r=P.isArray(r)?r:[]},i.getOwnTypeMetadata=c,i.hasClassMetadata=function(e,t){var r=P.isFunction(e)?e.toString():e;return Reflect.hasMetadata(r,t)},i.hasOwnClassMetadata=function(e,t){var r=P.isFunction(e)?e.toString():e;return Reflect.hasOwnMetadata(r,t)};var u="__method";function a(e,t){var r=P.isFunction(e)?e.toString():e,n=Reflect.getMetadata(r+u,t);return n&&!P.isArray(n)&&P.lang.hasField(n)||(n=Reflect.getMetadata(r+u,t.constructor)),P.isArray(n)?{}:n||{}}function p(e,t){var r=P.isFunction(e)?e.toString():e,n=Reflect.getOwnMetadata(r+u,t);return n&&!P.isArray(n)&&P.lang.hasField(n)||(n=Reflect.getOwnMetadata(r+u,t.constructor)),P.isArray(n)?{}:n||{}}i.getMethodMetadata=a,i.getOwnMethodMetadata=p,i.hasOwnMethodMetadata=function(e,t,r){var n=P.isFunction(e)?e.toString():e;if(r){var o=p(n,t);return o&&o.hasOwnProperty(r)}return Reflect.hasOwnMetadata(n+u,t)},i.hasMethodMetadata=function(e,t,r){var n=P.isFunction(e)?e.toString():e;if(r){var o=a(n,t);return o&&o.hasOwnProperty(r)}return Reflect.hasMetadata(n+u,t)};var l="__props";function f(e,t){var r=P.isFunction(e)?e.toString():e,n=Reflect.getMetadata(r+l,t);return n&&!P.isArray(n)&&P.lang.hasField(n)||(n=Reflect.getMetadata(r+l,t.constructor)),P.isArray(n)?{}:n||{}}function d(e,t){var r=P.isFunction(e)?e.toString():e,n=Reflect.getOwnMetadata(r+l,t);return n&&!P.isArray(n)&&P.lang.hasField(n)||(n=Reflect.getOwnMetadata(r+l,t.constructor)),P.isArray(n)?{}:n||{}}function h(e,t,r,n,o,a){var i=P.lang.assign({},d(t,r)),s=o||{};if(s.propertyKey=n,s.decorator=e,!s.type){var c=Reflect.getMetadata("design:type",r,n);c||(c=Reflect.getMetadata("design:type",r.constructor,n)),s.type=c}a&&a(s),i[n]&&P.isArray(i[n])||(i[n]=[]),i[n].unshift(s),Reflect.defineMetadata(t+l,i,r.constructor)}i.getPropertyMetadata=f,i.getOwnPropertyMetadata=d,i.hasPropertyMetadata=function(e,t,r){var n=P.isFunction(e)?e.toString():e;if(r){var o=f(n,t);return o&&o.hasOwnProperty(r)}return Reflect.hasMetadata(n+l,t)};var v="__params";function y(e,t,r){var n=P.isFunction(e)?e.toString():e,o=Reflect.getOwnMetadata(n+v,t,r);return o=P.isArray(o)?o:[]}function g(e){var t=Reflect.getMetadata(i.ParamerterName,e);return t&&!P.isArray(t)&&P.lang.hasField(t)||(t=Reflect.getMetadata(i.ParamerterName,e.constructor)),P.isArray(t)?{}:t||{}}function m(e){var r=P.lang.assign({},g(e)),t=Object.getOwnPropertyDescriptors(e.prototype),n=/^[a-z]/.test(e.name),o="",a=P.lang.getClassAnnations(e);a&&a.params&&(o=a.name,r=P.lang.assign(r,a.params)),n||e.name===o||(P.lang.forIn(t,function(e,t){"constructor"!==t&&(e.value&&(r[t]=_(e.value)),e.set&&(r[t]=_(e.set)))}),r.constructor=_(e.prototype.constructor)),Reflect.defineMetadata(i.ParamerterName,r,e)}i.getParamMetadata=function(e,t,r){var n=P.isFunction(e)?e.toString():e,o=Reflect.getMetadata(n+v,t,r);return o=P.isArray(o)?o:[]},i.getOwnParamMetadata=y,i.hasParamMetadata=function(e,t,r){var n=P.isFunction(e)?e.toString():e;return Reflect.hasMetadata(n+v,t,r)},i.hasOwnParamMetadata=function(e,t,r){var n=P.isFunction(e)?e.toString():e;return Reflect.hasOwnMetadata(n+v,t,r)},i.getParamerterNames=g,i.getOwnParamerterNames=function(e){var t=Reflect.getOwnMetadata(i.ParamerterName,e);return t&&!P.isArray(t)&&P.lang.hasField(t)||(t=Reflect.getOwnMetadata(i.ParamerterName,e.constructor)),P.isArray(t)?{}:t||{}},i.setParamerterNames=m;var n=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm,o=/([^\s,]+)/g;function _(e){if(!P.isFunction(e))return[];var t=e.toString().replace(n,""),r=t.slice(t.indexOf("(")+1,t.indexOf(")")).match(o);return null===r&&(r=[]),r}});t(A);A.ParamerterName,A.createDecorator,A.getClassDecorators,A.getMethodDecorators,A.getPropDecorators,A.getParamDecorators,A.getTypeMetadata,A.getOwnTypeMetadata,A.hasClassMetadata,A.hasOwnClassMetadata,A.getMethodMetadata,A.getOwnMethodMetadata,A.hasOwnMethodMetadata,A.hasMethodMetadata,A.getPropertyMetadata,A.getOwnPropertyMetadata,A.hasPropertyMetadata,A.getParamMetadata,A.getOwnParamMetadata,A.hasParamMetadata,A.hasOwnParamMetadata,A.getParamerterNames,A.getOwnParamerterNames,A.setParamerterNames;var k=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.createClassDecorator=function(e,t,r){var n=A.createDecorator(e,function(e){t&&t(e),e.next({match:function(e){return e&&(P.isSymbol(e)||P.isString(e)||P.isObject(e)&&e instanceof y.Registration)},setMetadata:function(e,t){e.provide=t}}),e.next({match:function(e){return P.isString(e)},setMetadata:function(e,t){e.alias=t}}),e.next({match:function(e){return P.isBoolean(e)||P.isNumber(e)||P.isToken(e)},setMetadata:function(e,t){P.isBoolean(t)?e.singleton=t:P.isNumber(t)?e.expires=t:P.isToken(t)&&(e.refs={target:t,provide:e.provide||e.type,alias:e.alias})}}),e.next({match:function(e){return P.isToken(e)},setMetadata:function(e,t){e.expires=t}})},r);return n.decoratorType=M.DecoratorType.Class,n}});t(k);k.createClassDecorator;var b=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.createMethodDecorator=function(e,t,r){var n=A.createDecorator(e,function(e){t&&t(e),e.next({match:function(e){return P.isArray(e)},setMetadata:function(e,t){e.providers=t}})},r);return n.decoratorType=M.DecoratorType.Method,n}});t(b);b.createMethodDecorator;var x=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.createParamDecorator=function(e,t,r){var n=A.createDecorator(e,function(e){t&&t(e),e.next({isMetadata:function(e){return P.isProvideMetadata(e,"index")},match:function(e){return P.isToken(e)},setMetadata:function(e,t){e.provider=t}})},r);return n.decoratorType=M.DecoratorType.Parameter,n}});t(x);x.createParamDecorator;var j=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.createPropDecorator=function(e,t,r){var n=A.createDecorator(e,function(e){t&&t(e),e.next({isMetadata:function(e){return P.isProvideMetadata(e)},match:function(e){return P.isToken(e)},setMetadata:function(e,t){e.provider=t}})},r);return n.decoratorType=M.DecoratorType.Property,n}});t(j);j.createPropDecorator;var S=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.createParamPropDecorator=function(e,t,r){var n=A.createDecorator(e,function(e){t&&t(e),e.next({isMetadata:function(e){return P.isProvideMetadata(e,"index")},match:function(e){return P.isToken(e)},setMetadata:function(e,t){e.provider=t}})},r);return n.decoratorType=M.DecoratorType.Property|M.DecoratorType.Parameter,n}});t(S);S.createParamPropDecorator;var I=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.createClassMethodDecorator=function(e,t,r){var n=A.createDecorator(e,t,r);return n.decoratorType=M.DecoratorType.Class|M.DecoratorType.Method,n}});t(I);I.createClassMethodDecorator;var O=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.createMethodPropDecorator=function(e,t,r){var n=A.createDecorator(e,t,r);return n.decoratorType=M.DecoratorType.Method|M.DecoratorType.Property,n}});t(O);O.createMethodPropDecorator;var w=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.createMethodPropParamDecorator=function(e,t,r){var n=A.createDecorator(e,t,r);return n.decoratorType=M.DecoratorType.Method|M.DecoratorType.Property|M.DecoratorType.Parameter,n}});t(w);w.createMethodPropParamDecorator;var R=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),l.__exportStar(T,t),l.__exportStar(M,t),l.__exportStar(A,t),l.__exportStar(k,t),l.__exportStar(b,t),l.__exportStar(x,t),l.__exportStar(j,t),l.__exportStar(S,t),l.__exportStar(I,t),l.__exportStar(O,t),l.__exportStar(w,t)});t(R);var D=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(n){function e(e,t){var r=n.call(this,e,t)||this;return r.type="Ref",r}return l.__extends(e,n),e.getClassAnnations=function(){return{name:"RefRegistration",params:{constructor:["provideType","desc"]}}},e}(y.Registration);t.RefRegistration=r;var n=function(n){function e(e,t){var r=n.call(this,e,"")||this;return r.target=t,r}return l.__extends(e,n),e.prototype.init=function(e){this.classType=this.format(e)},e.prototype.toString=function(){return"Ref "+n.prototype.toString.call(this)+" for "+this.format(this.target)},e.getClassAnnations=function(){return{name:"InjectReference",params:{constructor:["provideType","target"],init:["provideType"],toString:[]}}},e}(y.Registration);t.InjectReference=n,t.isInjectReference=function(e){return!!e&&(e instanceof n||P.isString(e)&&/^Ref\s+[\w\{\}]+\sfor/.test(e))};var o=function(t){function e(e){return t.call(this,e,"class_provides")||this}return l.__extends(e,t),e.getClassAnnations=function(){return{name:"InjectClassProvidesToken",params:{constructor:["provideType"]}}},e}(r);t.InjectClassProvidesToken=o});t(D);D.RefRegistration,D.InjectReference,D.isInjectReference,D.InjectClassProvidesToken;var E=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(){return e.call(this,C.CoreActions.bindProvider)||this}return l.__extends(t,e),t.prototype.working=function(e,t){var r=t.targetType,n=t.raiseContainer,o=e.getLifeScope().getClassDecorators(r,function(e){return e.actions.includes(C.CoreActions.bindProvider)}),a=new D.InjectClassProvidesToken(r),i=n.resolveValue(a)||{provides:[a.toString()],decors:[]};i.decors.length&&(o=o.filter(function(e){return i.decors.indexOf(e.name)<0})),o.length<1||(o.forEach(function(e){var t=R.getOwnTypeMetadata(e.name,r);i.decors.push(e.name),Array.isArray(t)&&0<t.length&&t.forEach(function(e){if(e){if(e.provide){var t=n.getToken(e.provide,e.alias);i.provides.push(t),n.bindProvider(t,e.type)}e.refs&&e.refs.target&&n.bindRefProvider(e.refs.target,e.refs.provide?e.refs.provide:e.type,e.type,e.refs.provide?e.refs.alias:"",function(e){return i.provides.push(e)}),e.providers&&e.providers.length&&n.bindProviders.apply(n,[e.type,function(e){return i.provides.push(e)}].concat(e.providers))}})}),n.bindProvider(a,i)),t.execResult=i.provides},t.getClassAnnations=function(){return{name:"BindProviderAction",params:{constructor:[],working:["container","data"]}}},t}(m.ActionComposite);t.BindProviderAction=r});t(E);E.BindProviderAction;var N=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(){return e.call(this,C.CoreActions.bindParameterType)||this}return l.__extends(t,e),t.prototype.working=function(n,e){if(!e.raiseContainer||e.raiseContainer===n){var o,r=e.target,a=e.targetType,i=e.propertyKey,s=n.getLifeScope();(o=(o=r&&i?Reflect.getMetadata("design:paramtypes",r,i)||[]:Reflect.getMetadata("design:paramtypes",a)||[]).slice(0)).forEach(function(e){s.isVaildDependence(e)&&(n.has(e)||n.register(e))}),s.getParameterDecorators(r||a,i,function(e){return e.actions.includes(C.CoreActions.bindParameterType)}).forEach(function(e){var t=r||"constructor"!==i?R.getParamMetadata(e.name,r,i):R.getOwnParamMetadata(e.name,a);P.isArray(t)&&t.length&&t.forEach(function(e){var t=P.isArray(e)&&0<e.length?e[0]:null;if(t&&0<=t.index){s.isVaildDependence(t.provider)&&(n.has(t.provider,t.alias)||n.register(n.getToken(t.provider,t.alias))),s.isVaildDependence(t.type)&&(n.has(t.type)||n.register(t.type));var r=t.provider?n.getTokenKey(t.provider,t.alias):t.type;r&&(o[t.index]=r)}})}),e.execResult=o}},t.getClassAnnations=function(){return{name:"BindParameterTypeAction",params:{constructor:[],working:["container","data"]}}},t}(m.ActionComposite);t.BindParameterTypeAction=r});t(N);N.BindParameterTypeAction;var F=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(){return e.call(this,C.CoreActions.bindPropertyType)||this}return l.__extends(t,e),t.prototype.working=function(n,e){if(!e.raiseContainer||e.raiseContainer===n){var o=e.targetType,a=n.getLifeScope(),t=a.getPropertyDecorators(o,function(e){return e.actions.includes(C.CoreActions.bindPropertyType)}),i=[];t.forEach(function(e){var t=R.getPropertyMetadata(e.name,o);for(var r in t)i=i.concat(t[r]);(i=i.filter(function(e){return!!e})).forEach(function(e){a.isVaildDependence(e.provider)&&(n.has(e.provider,e.alias)||n.register(n.getToken(e.provider,e.alias))),a.isVaildDependence(e.type)&&(n.has(e.type)||n.register(e.type))})}),e.execResult=i}},t.getClassAnnations=function(){return{name:"BindPropertyTypeAction",params:{constructor:[],working:["container","data"]}}},t}(m.ActionComposite);t.BindPropertyTypeAction=r});t(F);F.BindPropertyTypeAction;var B=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function r(e,t){this.type=e,this.value=t}return r.prototype.resolve=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return P.isUndefined(this.value)?e.has(this.type)?e.resolve.apply(e,[this.type].concat(t)):null:this.value},r.create=function(e,t){return new r(e,t)},r.createExtends=function(e,t,r){return new a(e,t,r)},r.createInvoke=function(e,t,r){return new n(e,t,r)},r.createParam=function(e,t,r,n){return new o(e,t,r,n)},r.getClassAnnations=function(){return{name:"Provider",params:{constructor:["type","value"],resolve:["container","providers"],create:["type","value"],createExtends:["token","value","extendsTarget"],createInvoke:["token","method","value"],createParam:["token","value","index","method"]}}},r}(),n=function(o){function e(e,t,r){var n=o.call(this,e,r)||this;return n.method=t,n}return l.__extends(e,o),e.prototype.resolve=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return this.method?e.syncInvoke.apply(e,[this.type,this.method].concat(t)):o.prototype.resolve.apply(this,[e].concat(t))},e.getClassAnnations=function(){return{name:"InvokeProvider",params:{constructor:["type","method","value"],resolve:["container","providers"]}}},e}(t.Provider=r),o=function(a){function e(e,t,r,n){var o=a.call(this,e,n,t)||this;return o.index=r,o}return l.__extends(e,a),e.prototype.resolve=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return a.prototype.resolve.apply(this,[e].concat(t))},e.getClassAnnations=function(){return{name:"ParamProvider",params:{constructor:["token","value","index","method"],resolve:["container","providers"]}}},e}(t.InvokeProvider=n);t.ParamProvider=o;var a=function(o){function e(e,t,r){var n=o.call(this,e,t)||this;return n.extendsTarget=r,n}return l.__extends(e,o),e.prototype.resolve=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return o.prototype.resolve.apply(this,[e].concat(t))},e.prototype.extends=function(e){P.isObject(e)&&P.isFunction(this.extendsTarget)&&this.extendsTarget(e,this)},e.getClassAnnations=function(){return{name:"ExtendsProvider",params:{constructor:["token","value","extendsTarget"],resolve:["container","providers"],extends:["target"]}}},e}(r);t.ExtendsProvider=a});t(B);B.Provider,B.InvokeProvider,B.ParamProvider,B.ExtendsProvider;var L=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ProviderMapToken=new a.InjectToken("DI_ProviderMap");var r=function(r){function e(e){var t=r.call(this)||this;return t.container=e,t}return l.__extends(e,r),e.prototype.has=function(e){return this.map.has(this.getTokenKey(e))},e.prototype.provides=function(){return this.keys().filter(function(e){return P.isToken(e)})},e.prototype.getTokenKey=function(e){return P.isToken(e)?this.container.getTokenKey(e):e},e.prototype.get=function(e){return this.map.get(this.getTokenKey(e))},e.prototype.getTokenImpl=function(e,t){return this.container.getTokenImpl(e,t)},e.prototype.unregister=function(e,t){var r=this.getTokenKey(e);return this.map.has(r)&&this.map.delete(r),this},e.prototype.add=function(e,n){var t,o=this,r=this.getTokenKey(e);return P.isUndefined(r)||(t=P.isToken(n)&&this.container.has(n)?function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return(e=o.container).resolve.apply(e,[n].concat(t))}:P.isFunction(n)?n:function(){return n})&&this.map.set(r,t),this},e.prototype.resolve=function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var o,a=this.getTokenKey(e);if(P.isNumber(t)?o=t:(t&&r.unshift(t),o=h.ResoveWay.current),o&h.ResoveWay.current&&this.map.has(a)){var i=this.map.get(a);return P.isFunction(i)?i.apply(void 0,r):null}return null},e.prototype.forEach=function(r){var n=this;this.map.forEach(function(e,t){!P.isNumber(t)&&r(t,e,n)})},e.prototype.copy=function(e){var r=this;return e&&this.map.forEach(function(e,t){r.map.set(t,e)}),this},e.getClassAnnations=function(){return{name:"ProviderMap",params:{constructor:["container"],has:["provide"],provides:[],getTokenKey:["token"],get:["provide"],getTokenImpl:["token","resway"],unregister:["token","resway"],add:["provide","provider"],resolve:["provide","resway","providers"],forEach:["callbackfn"],copy:["map"]}}},e}(P.MapBase);t.ProviderMap=r,t.isProviderMap=function(e){return!!P.isObject(e)&&e instanceof r}});t(L);L.ProviderMapToken,L.ProviderMap,L.isProviderMap;var K=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ProviderParserToken=new a.InjectToken("DI_IProviderParser")});t(K);K.ProviderParserToken;var V=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this.container=e}return e.prototype.parse=function(){for(var o=this,e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(1===e.length&&L.isProviderMap(e[0]))return e[0];var a=this.container.resolve(L.ProviderMapToken);return e.forEach(function(r,e){if(!P.isUndefined(r)&&!P.isNull(r))if(L.isProviderMap(r))a.copy(r);else if(r instanceof B.Provider)r instanceof B.ParamProvider?!r.type&&P.isNumber(r.index)?a.add(r.index,function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.resolve.apply(r,[o.container].concat(e))}):a.add(r.type,function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.resolve.apply(r,[o.container].concat(e))}):a.add(r.type,function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.resolve.apply(r,[o.container].concat(e))});else if(P.isClass(r))o.container.has(r)||o.container.register(r),a.add(r,r);else if(P.isBaseObject(r)){var n=r,t=!1;P.isToken(n.provide)?(P.isArray(n.deps)&&n.deps.length&&n.deps.forEach(function(e){P.isClass(e)&&!o.container.has(e)&&o.container.register(e)}),P.isUndefined(n.useValue)?P.isClass(n.useClass)?(o.container.has(n.useClass)||o.container.register(n.useClass),a.add(n.provide,n.useClass)):P.isFunction(n.useFactory)?a.add(n.provide,function(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];var t=[];return P.isArray(n.deps)&&n.deps.length&&(t=n.deps.map(function(e){var t;return P.isToken(e)?(t=o.container).resolve.apply(t,[e].concat(r)):e})),n.useFactory.apply(n,t)}):P.isToken(n.useExisting)?a.add(n.provide,function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return(e=o.container).resolve.apply(e,[n.useExisting].concat(t))}):t=!0:a.add(n.provide,function(){return n.useValue})):t=!0,t&&P.lang.forIn(r,function(e,t){t&&P.isString(t)&&a.add(t,function(){return e})})}else P.isFunction(r)&&a.add(name,function(){return r})}),a},e.getClassAnnations=function(){return{name:"ProviderParser",params:{constructor:["container"],parse:["providers"]}}},e}();t.ProviderParser=r,t.isProvider=function(e){return L.isProviderMap(e)||P.isBaseObject(e)||e instanceof B.Provider}});t(V);V.ProviderParser,V.isProvider;var W=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),l.__exportStar(B,t),l.__exportStar(L,t),l.__exportStar(K,t),l.__exportStar(V,t)});t(W);var U=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(){return e.call(this,C.CoreActions.injectProperty)||this}return l.__extends(t,e),t.prototype.working=function(o,a){if(a.execResult||this.parent.find(function(e){return e.name===C.CoreActions.bindPropertyType}).execute(o,a),a.target&&a.execResult&&a.execResult.length){var i=a.providerMap;a.injecteds=a.injecteds||{},a.execResult.forEach(function(e,t){if(e&&!a.injecteds[e.propertyKey]){var r=e.provider?o.getToken(e.provider,e.alias):e.type,n=o.get(new D.InjectReference(W.ProviderMap,a.targetType));r===h.ContainerToken&&Object.defineProperty(a.target,e.propertyKey,{enumerable:!1,writable:!0}),n&&n.has(r)?(a.target[e.propertyKey]=n.resolve(r,i),a.injecteds[e.propertyKey]=!0):i&&i.has(r)?(a.target[e.propertyKey]=i.resolve(r,i),a.injecteds[e.propertyKey]=!0):o.has(r)&&(a.target[e.propertyKey]=o.resolve(r,i),a.injecteds[e.propertyKey]=!0)}})}},t.getClassAnnations=function(){return{name:"InjectPropertyAction",params:{constructor:[],working:["container","data"]}}},t}(m.ActionComposite);t.InjectPropertyAction=r});t(U);U.InjectPropertyAction;var z=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(){return e.call(this,C.CoreActions.bindParameterProviders)||this}return l.__extends(t,e),t.prototype.working=function(e,t){if(!t.raiseContainer||t.raiseContainer===e){var r=t.targetType,n=t.propertyKey,o=e.getLifeScope().getMethodDecorators(r,function(e){return e.actions.includes(C.CoreActions.bindParameterProviders)&&R.hasOwnMethodMetadata(e.name,r)}),a=[];o.forEach(function(e){var t=R.getOwnMethodMetadata(e.name,r)[n];t&&P.isArray(t)&&0<t.length&&t.forEach(function(e){e.providers&&0<e.providers.length&&(a=a.concat(e.providers))})}),t.execResult=a}},t.getClassAnnations=function(){return{name:"BindParameterProviderAction",params:{constructor:[],working:["container","data"]}}},t}(m.ActionComposite);t.BindParameterProviderAction=r});t(z);z.BindParameterProviderAction;var $=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(){return e.call(this,C.CoreActions.componentBeforeInit)||this}return l.__extends(t,e),t.prototype.working=function(e,t){if((!t.raiseContainer||t.raiseContainer===e)&&t.targetType&&t.target&&e.getLifeScope().hasDecorator(t.targetType,R.DecoratorType.Class,function(e){return e.actions.includes(C.CoreActions.componentBeforeInit)})){var r=t.target;P.isFunction(r.beforeInit)&&e.syncInvoke(t.target||t.targetType,"beforeInit",t.target)}},t.getClassAnnations=function(){return{name:"ComponentBeforeInitAction",params:{constructor:[],working:["container","data"]}}},t}(m.ActionComposite);t.ComponentBeforeInitAction=r});t($);$.ComponentBeforeInitAction;var q=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(){return e.call(this,C.CoreActions.componentInit)||this}return l.__extends(t,e),t.prototype.working=function(e,t){if((!t.raiseContainer||t.raiseContainer===e)&&t.targetType&&t.target&&e.getLifeScope().hasDecorator(t.targetType,R.DecoratorType.Class,function(e){return e.actions.includes(C.CoreActions.componentInit)})){var r=t.target;P.isFunction(r.onInit)&&e.syncInvoke(t.target||t.targetType,"onInit",t.target)}},t.getClassAnnations=function(){return{name:"ComponentInitAction",params:{constructor:[],working:["container","data"]}}},t}(m.ActionComposite);t.ComponentInitAction=r});t(q);q.ComponentInitAction;var G=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(){return e.call(this,C.CoreActions.componentAfterInit)||this}return l.__extends(t,e),t.prototype.working=function(e,t){if((!t.raiseContainer||t.raiseContainer===e)&&t.targetType&&t.target&&e.getLifeScope().hasDecorator(t.targetType,R.DecoratorType.Class,function(e){return e.actions.includes(C.CoreActions.componentAfterInit)})){var r=t.target;P.isFunction(r.afterInit)&&e.syncInvoke(t.target||t.targetType,"afterInit",t.target)}},t.getClassAnnations=function(){return{name:"ComponentAfterInitAction",params:{constructor:[],working:["container","data"]}}},t}(m.ActionComposite);t.ComponentAfterInitAction=r});t(G);G.ComponentAfterInitAction;var Z=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.CacheManagerToken=new a.InjectToken("DI_ICacheManager")});t(Z);Z.CacheManagerToken;var H=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(){return e.call(this,C.CoreActions.cache)||this}return l.__extends(t,e),t.prototype.working=function(e,t){if(t.raiseContainer&&t.raiseContainer!==e)return t;if(t.singleton||!t.targetType||!P.isClass(t.targetType))return t;var r=e.get(Z.CacheManagerToken);if(t.target){if(!r.hasCache(t.targetType))(n=this.getCacheMetadata(e,t))&&r.cache(t.targetType,t.target,n.expires)}else{var n,o=r.get(t.targetType);if(o)(n=this.getCacheMetadata(e,t))&&(r.cache(t.targetType,o,n.expires),t.execResult=o)}return t},t.prototype.getCacheMetadata=function(e,t){for(var r,n=e.getLifeScope().getClassDecorators(t.targetType),o=0;o<n.length;o++){var a=n[o],i=R.getOwnTypeMetadata(a.name,t.targetType);if(Array.isArray(i)&&0<i.length&&(r=i.find(function(e){return e&&P.isNumber(e.expires)&&0<e.expires})))break}return r},t.getClassAnnations=function(){return{name:"CacheAction",params:{constructor:[],working:["container","data"],getCacheMetadata:["container","data"]}}},t}(m.ActionComposite);t.CacheAction=r});t(H);H.CacheAction;var J=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(){return e.call(this,C.CoreActions.singletion)||this}return l.__extends(t,e),t.prototype.working=function(e,t){t.raiseContainer&&t.raiseContainer!==e||t.tokenKey&&t.target&&t.singleton&&e.registerValue(t.tokenKey,t.target)},t.getClassAnnations=function(){return{name:"SingletionAction",params:{constructor:[],working:["container","data"]}}},t}(m.ActionComposite);t.SingletionAction=r});t(J);J.SingletionAction;var Q=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Autorun=R.createClassMethodDecorator("Autorun",function(e){e.next({isMetadata:function(e){return P.isClassMetadata(e,"autorun")},match:function(e){return P.isString(e)||P.isNumber(e)},setMetadata:function(e,t){P.isString(t)?e.autorun=t:e.order=t}})},function(e){return e.singleton=!0,e})});t(Q);Q.Autorun;var X=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.IocExt=R.createClassDecorator("IocExt",function(e){e.next({isMetadata:function(e){return P.isClassMetadata(e,"autorun")},match:function(e){return P.isString(e)},setMetadata:function(e,t){e.autorun=t}})},function(e){return e.singleton=!0,e}),t.IocModule=t.IocExt});t(X);X.IocExt,X.IocModule;var Y=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(){return e.call(this,C.CoreActions.autorun)||this}return l.__extends(t,e),t.prototype.getDecorator=function(){return[X.IocExt,Q.Autorun]},t.prototype.working=function(o,a){a.raiseContainer&&a.raiseContainer!==o||a.tokenKey&&a.targetType&&this.getDecorator().forEach(function(e){if(R.hasClassMetadata(e,a.targetType)){var t=R.getTypeMetadata(e,a.targetType),r=t.find(function(e){return!!e.autorun});if(!r&&t.length&&(r=t[0]),r){var n=o.get(a.tokenKey);n&&r.autorun&&P.isFunction(n[r.autorun])&&o.syncInvoke(n,r.autorun)}}})},t.getClassAnnations=function(){return{name:"AutorunAction",params:{constructor:[],getDecorator:[],working:["container","data"]}}},t}(m.ActionComposite);t.AutorunAction=r});t(Y);Y.AutorunAction;var ee=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),l.__exportStar(m,t),l.__exportStar(_,t),l.__exportStar(C,t),l.__exportStar(g,t),l.__exportStar(E,t),l.__exportStar(N,t),l.__exportStar(F,t),l.__exportStar(U,t),l.__exportStar(z,t),l.__exportStar($,t),l.__exportStar(q,t),l.__exportStar(G,t),l.__exportStar(H,t),l.__exportStar(J,t),l.__exportStar(Y,t)});t(ee);var te=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.enumerable=function(n){return function(e,t,r){r?r.enumerable=n:((r=Object.getOwnPropertyDescriptor(e,t)||{writable:!0}).enumerable=n,Object.defineProperty(e,t,r))}},t.configurable=function(n){return function(e,t,r){r?r.configurable=n:((r=Object.getOwnPropertyDescriptor(e,t)||{writable:!0}).configurable=n,Object.defineProperty(e,t,r))}},t.sealed=function(e){Object.seal(e),Object.seal(e.prototype)}});t(te);te.enumerable,te.configurable,te.sealed;var re=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Component=R.createClassDecorator("Component")});t(re);re.Component;var ne=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Injectable=R.createClassDecorator("Injectable")});t(ne);ne.Injectable;var oe=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Refs=R.createDecorator("Refs",function(e){e.next({match:function(e){return P.isToken(e)},setMetadata:function(e,t){e.refs={target:t}}}),e.next({match:function(e){return P.isToken(e)},setMetadata:function(e,t){e.refs.provide=t}}),e.next({match:function(e){return P.isString(e)},setMetadata:function(e,t){e.refs.alias=t}})})});t(oe);oe.Refs;var ae=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Providers=R.createDecorator("Providers",function(e){e.next({match:function(e){return P.isArray(e)},setMetadata:function(e,t){e.providers=t}})})});t(ae);ae.Providers;var ie=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Inject=R.createParamPropDecorator("Inject")});t(ie);ie.Inject;var se=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.AutoWired=R.createParamPropDecorator("AutoWired")});t(se);se.AutoWired;var ce=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Param=R.createParamDecorator("Param")});t(ce);ce.Param;var ue=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Method=R.createMethodDecorator("Method")});t(ue);ue.Method;var pe=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Singleton=R.createClassDecorator("Singleton",null,function(e){return e.singleton=!0,e})});t(pe);pe.Singleton;var le=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Abstract=R.createClassDecorator("Abstract")});t(le);le.Abstract;var fe=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),l.__exportStar(te,t),l.__exportStar(re,t),l.__exportStar(ne,t),l.__exportStar(oe,t),l.__exportStar(ae,t),l.__exportStar(ie,t),l.__exportStar(se,t),l.__exportStar(ce,t),l.__exportStar(ue,t),l.__exportStar(pe,t),l.__exportStar(le,t),l.__exportStar(Q,t),l.__exportStar(X,t)});t(fe);var de=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.RecognizerToken=new a.InjectToken("DI_IRecognizer")});t(de);de.RecognizerToken;var he=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(){return e.call(this,C.CoreActions.methodAutorun)||this}return l.__extends(t,e),t.prototype.working=function(t,r){if((!r.raiseContainer||r.raiseContainer===t)&&r.target&&r.targetType&&R.hasMethodMetadata(fe.Autorun,r.targetType)){var e=R.getMethodMetadata(fe.Autorun,r.targetType),n=[],o=P.lang.keys(e).length;P.lang.forIn(e,function(e,t){if(e&&e.length){var r=e[0];r.autorun=t,o++,P.isNumber(r.order)||(r.order=o),n.push(r)}}),n.sort(function(e,t){return e.order-e.order}).forEach(function(e){t.syncInvoke(r.target||r.targetType,e.autorun,r.target)})}},t.getClassAnnations=function(){return{name:"MethodAutorun",params:{constructor:[],working:["container","data"]}}},t}(m.ActionComposite);t.MethodAutorun=r});t(he);he.MethodAutorun;var ve=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.prototype.create=function(e){var t;switch(e){case ee.CoreActions.bindParameterType:t=new ee.BindParameterTypeAction;break;case ee.CoreActions.bindPropertyType:t=new ee.BindPropertyTypeAction;break;case ee.CoreActions.injectProperty:t=new ee.InjectPropertyAction;break;case ee.CoreActions.bindProvider:t=new ee.BindProviderAction;break;case ee.CoreActions.bindParameterProviders:t=new ee.BindParameterProviderAction;break;case ee.CoreActions.componentInit:t=new ee.ComponentInitAction;break;case ee.CoreActions.componentBeforeInit:t=new ee.ComponentBeforeInitAction;break;case ee.CoreActions.componentAfterInit:t=new ee.ComponentAfterInitAction;break;case ee.CoreActions.cache:t=new ee.CacheAction;break;case ee.CoreActions.singletion:t=new ee.SingletionAction;break;case ee.CoreActions.autorun:t=new ee.AutorunAction;break;case ee.CoreActions.methodAutorun:t=new he.MethodAutorun;break;default:t=new ee.ActionComposite(e)}return t},e.getClassAnnations=function(){return{name:"ActionFactory",params:{create:["type"]}}},e}();t.ActionFactory=r});t(ve);ve.ActionFactory;var ye=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(t){function e(e){return t.call(this,e,"metaAccessor")||this}return l.__extends(e,t),e.getClassAnnations=function(){return{name:"InjectMetaAccessorToken",params:{constructor:["type"]}}},e}(D.RefRegistration);t.InjectMetaAccessorToken=r,t.MetaAccessorToken=new r(Object)});t(ye);ye.InjectMetaAccessorToken,ye.MetaAccessorToken;var ge=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this.container=e,this.decorators=[],this.buildAction()}return e.prototype.addAction=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n=this.action;return t.forEach(function(t){n=n.find(function(e){return e.name===t})}),n&&n.add(e),this},e.prototype.registerDecorator=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n=this.getDecoratorType(e);return this.registerCustomDecorator.apply(this,[e,n].concat(t))},e.prototype.registerCustomDecorator=function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var o=this.toActionName(t),a=e.toString();return this.decorators.some(function(e){return e.name===a})||this.decorators.push({name:a,types:o,actions:r}),this},e.prototype.execute=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];t=t.filter(function(e){return!!e});var n=this.action;t.forEach(function(t){n=n.find(function(e){return e.name===t})}),n&&n.execute(this.container,e)},e.prototype.routeExecute=function(e){for(var t,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];this.execute.apply(this,[e].concat(r));for(var o=this.container.parent;o;)(t=o.getLifeScope()).execute.apply(t,[P.lang.assign({},e)].concat(r)),o=o.parent},e.prototype.hasDecorator=function(e,t,r){var n,o=this;switch(t){case R.DecoratorType.Class:n=R.getClassDecorators(e);break;case R.DecoratorType.Property:n=R.getPropDecorators(e);break;case R.DecoratorType.Parameter:n=R.getParamDecorators(e);break;case R.DecoratorType.Method:n=R.getMethodDecorators(e)}return!!n&&n.some(function(t){return o.decorators.some(function(e){return e.name===t&&r(e)})})},e.prototype.getClassDecorators=function(e,t){var r=this;return R.getClassDecorators(e).map(function(t){return r.decorators.find(function(e){return e.name===t})}).filter(function(e){return e&&(!t||t(e))})},e.prototype.getMethodDecorators=function(e,t){var r=this;return R.getMethodDecorators(e).map(function(t){return r.decorators.find(function(e){return e.name===t})}).filter(function(e){return e&&(!t||t(e))})},e.prototype.getPropertyDecorators=function(e,t){var r=this;return R.getPropDecorators(e).map(function(t){return r.decorators.find(function(e){return e.name===t})}).filter(function(e){return e&&(!t||t(e))})},e.prototype.getParameterDecorators=function(e,t,r){var n=this;return R.getParamDecorators(e,t).map(function(t){return n.decorators.find(function(e){return e.name===t})}).filter(function(e){return e&&(!r||r(e))})},e.prototype.getDecoratorType=function(e){return e.decoratorType||R.DecoratorType.All},e.prototype.isVaildDependence=function(e){return!!e&&(!!P.isClass(e)&&(!P.isAbstractClass(e)&&0<this.getClassDecorators(e).length))},e.prototype.getAtionByName=function(t){return this.action.find(function(e){return e.name===t})},e.prototype.getClassAction=function(){return this.getAtionByName(this.toActionName(R.DecoratorType.Class))},e.prototype.getMethodAction=function(){return this.getAtionByName(this.toActionName(R.DecoratorType.Method))},e.prototype.getPropertyAction=function(){return this.getAtionByName(this.toActionName(R.DecoratorType.Property))},e.prototype.getParameterAction=function(){return this.getAtionByName(this.toActionName(R.DecoratorType.Parameter))},e.prototype.getConstructorParameters=function(e){return this.getParameters(e)},e.prototype.getMethodParameters=function(e,t,r){return this.getParameters(e,t,r)},e.prototype.getParamerterNames=function(e,t){var r=R.getOwnParamerterNames(e),n=[];return r&&r.hasOwnProperty(t)&&(n=r[t]),P.isArray(n)||(n=[]),n},e.prototype.isSingletonType=function(e){return!!R.hasOwnClassMetadata(pe.Singleton,e)||!!this.container.get(ye.MetaAccessorToken).find(e,this.container,function(e){return!0===e.singleton})},e.prototype.getMethodMetadatas=function(r,n){var o=[];return this.getMethodDecorators(r).forEach(function(e){var t=R.getOwnMethodMetadata(e.name,r);t.hasOwnProperty(n)&&(o=o.concat(t[n]||[]))}),o},e.prototype.filerDecorators=function(e){return this.decorators.filter(e)},e.prototype.getParameters=function(e,t,r){var n={target:t,targetType:e,propertyKey:r=r||"constructor"};this.execute(n,ee.LifeState.onInit,ee.CoreActions.bindParameterType);var o=this.getParamerterNames(e,r);return n.execResult.length?n.execResult.map(function(e,t){return{type:e,name:o[t]}}):o.map(function(e){return{name:e,type:void 0}})},e.prototype.getTypeDecorators=function(r,n){return this.filerDecorators(function(e){var t=0<=(e.types||"").indexOf(r);return t&&n&&(t=n(e)),t})},e.prototype.buildAction=function(){var e=new ve.ActionFactory,t=e.create("");t.add(e.create(d.IocState.design).add(e.create(ee.CoreActions.bindProvider)).add(e.create(ee.CoreActions.autorun))).add(e.create(d.IocState.runtime).add(e.create(ee.LifeState.beforeCreateArgs)).add(e.create(ee.LifeState.beforeConstructor)).add(e.create(ee.LifeState.afterConstructor)).add(e.create(ee.LifeState.onInit).add(e.create(ee.CoreActions.componentBeforeInit)).add(e.create(this.toActionName(R.DecoratorType.Class))).add(e.create(this.toActionName(R.DecoratorType.Method))).add(e.create(this.toActionName(R.DecoratorType.Property)).add(e.create(ee.CoreActions.bindPropertyType)).add(e.create(ee.CoreActions.injectProperty))).add(e.create(this.toActionName(R.DecoratorType.Parameter)).add(e.create(ee.CoreActions.bindParameterType)).add(e.create(ee.CoreActions.bindParameterProviders))).add(e.create(ee.CoreActions.componentInit))).add(e.create(ee.LifeState.AfterInit).add(e.create(ee.CoreActions.singletion)).add(e.create(ee.CoreActions.componentAfterInit)).add(e.create(ee.CoreActions.methodAutorun)))).add(e.create(ee.CoreActions.cache)),this.action=t},e.prototype.toActionName=function(e){var t=[];return e&R.DecoratorType.Class&&t.push("ClassDecorator"),e&R.DecoratorType.Method&&t.push("MethodDecorator"),e&R.DecoratorType.Property&&t.push("PropertyDecorator"),e&R.DecoratorType.Parameter&&t.push("ParameterDecorator"),t.join(",")},e.getClassAnnations=function(){return{name:"DefaultLifeScope",params:{constructor:["container"],addAction:["action","nodepaths"],registerDecorator:["decorator","actions"],registerCustomDecorator:["decorator","type","actions"],execute:["data","names"],routeExecute:["data","names"],hasDecorator:["target","dtype","match"],getClassDecorators:["type","match"],getMethodDecorators:["type","match"],getPropertyDecorators:["type","match"],getParameterDecorators:["target","propertyKey","match"],getDecoratorType:["decirator"],isVaildDependence:["target"],getAtionByName:["name"],getClassAction:[],getMethodAction:[],getPropertyAction:[],getParameterAction:[],getConstructorParameters:["type"],getMethodParameters:["type","instance","propertyKey"],getParamerterNames:["type","propertyKey"],isSingletonType:["type"],getMethodMetadatas:["type","propertyKey"],filerDecorators:["express"],getParameters:["type","instance","propertyKey"],getTypeDecorators:["decType","match"],buildAction:[],toActionName:["type"]}}},e}();t.DefaultLifeScope=r});t(ge);ge.DefaultLifeScope;var me=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.prototype.getDecorators=function(e){return R.getClassDecorators(e)},e.prototype.getMetadata=function(e,t,r,n){var o,a=P.isClass(e)?e:t.getTokenImpl(e);if(P.isClass(a)){var i=this.getDecorators(a);n&&(i=i.filter(n));var s={};i.forEach(function(e){var t=R.getTypeMetadata(e,a);t&&t.length&&t.forEach(function(e){e&&(s=P.lang.assign({},s,e))})}),o=s}return o?P.lang.assign({},o,r||{}):r||{}},e.prototype.find=function(e,t,r,n){var o=P.isClass(e)?e:t.getTokenImpl(e),a=null;if(P.isClass(o)){var i=this.getDecorators(o);n&&(i=i.filter(n)),i.some(function(e){var t=R.getTypeMetadata(e,o);return!(!t||!t.length)&&t.some(function(e){return e&&r(e)&&(a=e),!!a})})}return a},e.prototype.filter=function(e,t,r,n){var o=P.isClass(e)?e:t.getTokenImpl(e),a=[];if(P.isClass(o)){var i=this.getDecorators(o);n&&(i=i.filter(n)),i.forEach(function(e){var t=R.getTypeMetadata(e,o);t&&t.length&&t.filter(function(e){return e&&r(e)}).forEach(function(e){a.push(e)})})}return a},e.prototype.getToken=function(e,t){var r=this.getTokenInConfig(e);return this.validateToken(r,t)?r:null},e.prototype.getBootToken=function(e,t){var r=this.getBootTokenInConfig(e);return this.validateToken(r,t)?r:null},e.prototype.validateToken=function(e,t){return P.isToken(e)},e.prototype.getTokenInConfig=function(e){return e.token||e.type},e.prototype.getBootTokenInConfig=function(e){return e.bootstrap},e.getClassAnnations=function(){return{name:"MetaAccessor",params:{constructor:[],getDecorators:["type"],getMetadata:["token","container","extConfig","decorFilter"],find:["token","container","filter","decorFilter"],filter:["token","container","filter","decorFilter"],getToken:["config","container"],getBootToken:["config","container"],validateToken:["token","container"],getTokenInConfig:["config"],getBootTokenInConfig:["config"]}}},e}();t.MetaAccessor=r});t(me);me.MetaAccessor;var _e=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this.container=e}return e.prototype.invoke=function(s,c,u){for(var p=[],e=3;e<arguments.length;e++)p[e-3]=arguments[e];return l.__awaiter(this,void 0,void 0,function(){var t,r,n,o,a,i;return l.__generator(this,function(e){switch(e.label){case 0:return W.isProvider(u)&&(p.unshift(u),u=void 0),P.isToken(s)?(P.isNullOrUndefined(u)?(r=this.container.getTokenImpl(s),u=(t=this.container).resolve.apply(t,[s].concat(p))):r=P.lang.getClass(u)||this.container.getTokenImpl(s),P.lang.assert(r,s.toString()+" is not implements by any class.")):(r=P.lang.getClass(s),u=s),P.lang.assertExp(u&&P.isFunction(u[c]),"type: "+r+" has no method "+c.toString()+"."),n={target:u,targetType:r,propertyKey:c},(o=this.container.getLifeScope()).execute(n,ee.LifeState.onInit,ee.CoreActions.bindParameterProviders),p=p.concat(n.execResult),a=o.getMethodParameters(r,u,c),[4,this.createParams.apply(this,[a].concat(p))];case 1:return i=e.sent(),[2,u[c].apply(u,i)]}})})},e.prototype.syncInvoke=function(e,t,r){for(var n,o,a=[],i=3;i<arguments.length;i++)a[i-3]=arguments[i];W.isProvider(r)&&(a.unshift(r),r=void 0),P.isToken(e)?(o=this.container.getTokenImpl(e),P.lang.assert(o,e.toString()+" is not implements by any class."),P.isNullOrUndefined(r)&&(r=(n=this.container).resolve.apply(n,[e].concat(a)))):(o=P.lang.getClass(e),r=e),P.lang.assertExp(r&&P.isFunction(r[t]),"type: "+o+" has no method "+t.toString()+".");var s={target:r,targetType:o,propertyKey:t},c=this.container.getLifeScope();c.execute(s,ee.LifeState.onInit,ee.CoreActions.bindParameterProviders),a=a.concat(s.execResult);var u=c.getMethodParameters(o,r,t),p=this.createSyncParams.apply(this,[u].concat(a));return r[t].apply(r,p)},e.prototype.createSyncParams=function(e){for(var t,r=this,n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];var a=(t=this.container.getProviderParser()).parse.apply(t,n);return e.map(function(e,t){return e.name&&a.has(e.name)?a.resolve(e.name):P.isToken(e.type)?a.has(e.type)?a.resolve(e.type):r.container.resolve(e.type,a):void 0})},e.prototype.createParams=function(e){for(var t,r=this,n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];var a=(t=this.container.getProviderParser()).parse.apply(t,n);return Promise.all(e.map(function(e,t){return e.name&&a.has(e.name)?a.resolve(e.name):P.isToken(e.type)?a.has(e.type)?a.resolve(e.type):r.container.resolve(e.type,a):void 0}))},e.getClassAnnations=function(){return{name:"MethodAccessor",params:{constructor:["container"],invoke:["target","propertyKey","instance","providers"],syncInvoke:["target","propertyKey","instance","providers"],createSyncParams:["params","providers"],createParams:["params","providers"]}}},e}();t.MethodAccessor=r});t(_e);_e.MethodAccessor;var Pe=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this.container=e,this.cacheTokens=new Map}return e.prototype.isChecking=function(){return!!this.timeout},e.prototype.hasCache=function(e){return this.cacheTokens.has(e)},e.prototype.cache=function(e,t,r){var n;this.hasCache(e)?(n=this.cacheTokens.get(e)).expires=Date.now()+r:n={target:t,expires:Date.now()+r},this.cacheTokens.set(e,n),this.isChecking()||this.checkExpires()},e.prototype.get=function(e,t){var r=null;if(!this.cacheTokens.has(e))return null;var n=this.cacheTokens.get(e);return n.expires<=Date.now()?(r=n.target,P.isNumber(t)&&0<t&&(n.expires=Date.now()+t,this.cacheTokens.set(e,n))):this.destroy(e,n.target),r},e.prototype.checkExpires=function(){var t=this;if(this.timeout&&(clearTimeout(this.timeout),this.timeout=0),0<this.cacheTokens.size){var r=[];this.cacheTokens.forEach(function(e,t){e.expires>=Date.now()&&r.push(t)}),r.length&&r.forEach(function(e){t.destroy(e,t.cacheTokens.get(e).target)}),this.timeout=setTimeout(function(){t.checkExpires()},6e4)}},e.prototype.destroy=function(e,t){if(this.hasCache(e)){t||(t=this.cacheTokens.get(e).target);try{var r=t;P.isFunction(r.onDestroy)&&this.container.syncInvoke(t||e,"onDestroy",t),this.cacheTokens.delete(e)}catch(e){console.error&&console.error(e)}}},e.getClassAnnations=function(){return{name:"CacheManager",params:{constructor:["container"],isChecking:[],hasCache:["targetType"],cache:["targetType","target","expires"],get:["targetType","expires"],checkExpires:[],destroy:["targetType","target"]}}},e}();t.CacheManager=r});t(Pe);Pe.CacheManager;var Ce=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),l.__exportStar(ee,t),l.__exportStar(fe,t),l.__exportStar(R,t),l.__exportStar(de,t),l.__exportStar(ve,t),l.__exportStar(ge,t),l.__exportStar(ye,t),l.__exportStar(me,t),l.__exportStar(_e,t),l.__exportStar(Pe,t)});t(Ce);var Te=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ContainerBuilderToken=new a.InjectToken("DI_IContainerBuilder")});t(Te);Te.ContainerBuilderToken;var Me=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.LifeScopeToken=new a.InjectToken("DI_LifeScope")});t(Me);Me.LifeScopeToken;var Ae=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ResolverChainToken=new a.InjectToken("di_ResolverChain");var r=function(){function e(e){this.container=e,this.resolvers=[]}return Object.defineProperty(e.prototype,"size",{get:function(){return this.resolvers.length+1},enumerable:!0,configurable:!0}),e.prototype.next=function(e){this.hasResolver(e)||this.resolvers.push(e)},e.prototype.hasResolver=function(e){return e===this.container||0<=this.resolvers.indexOf(e)},e.prototype.resolve=function(e,t){for(var r,n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];var a,i,s=this.container.getTokenKey(e,P.isString(t)?t:null);if(P.isNumber(t)?a=t:(t&&n.unshift(t),a=h.ResoveWay.all),n.length&&(i=1===n.length&&W.isProviderMap(n[0])?n[0]:(r=this.container.getProviderParser()).parse.apply(r,n)),i&&i.has(e))return i.resolve(e,i);if(a&h.ResoveWay.current&&this.container.hasRegister(s))return this.container.resolveValue(s,i);if(a&h.ResoveWay.traverse){var c=this.resolvers.find(function(e){return e.has(s,h.ResoveWay.nodes)});if(c)return c.resolve(s,h.ResoveWay.nodes,i)}return this.container.parent&&a&h.ResoveWay.bubble?this.container.parent.resolve(s,t,i):null},e.prototype.unregister=function(e,t){t=t||h.ResoveWay.all;var r=this.container.getTokenKey(e);return t&h.ResoveWay.current&&this.container.unregisterValue(r),t&h.ResoveWay.traverse&&this.resolvers.forEach(function(e){P.isFunction(e.unregister)&&e.unregister(r,h.ResoveWay.nodes)}),t&h.ResoveWay.bubble&&this.container.parent&&this.container.parent.unregister(e,t),this},e.prototype.getTokenImpl=function(e,t){if(P.isClass(e))return e;t=t||h.ResoveWay.nodes;var r,n=this.container.getTokenKey(e);return t&h.ResoveWay.current&&(r=this.container.getTokenProvider(n)),!r&&t&h.ResoveWay.traverse&&this.resolvers.some(function(e){return!!P.isFunction(e.getTokenImpl)&&!!(r=e.getTokenImpl(n,h.ResoveWay.nodes))}),!r&&t&h.ResoveWay.bubble&&this.container.parent&&(r=this.container.parent.getTokenImpl(e,t)),r||null},e.prototype.has=function(e,t){var r=this.container.getTokenKey(e,P.isString(t)?t:null),n=P.isNumber(t)?t:h.ResoveWay.all;return!!(n&h.ResoveWay.current&&this.container.hasRegister(r))||(!!(n&h.ResoveWay.traverse&&this.resolvers.some(function(e){return e.has(r,h.ResoveWay.nodes)}))||!!(n&h.ResoveWay.bubble&&this.container.parent)&&this.container.parent.has(e,n))},e.prototype.toArray=function(e){return void 0===e&&(e=h.ResoveWay.all),e&h.ResoveWay.nodes?[this.container].concat(this.resolvers):e&h.ResoveWay.current?[this.container]:e&h.ResoveWay.traverse?this.resolvers:[]},e.prototype.forEach=function(t){return!1!==this.container.forEach(t)&&!this.resolvers.some(function(e){return!!P.isFunction(e.forEach)&&!1===e.forEach(t)})},e.prototype.iterator=function(t,e){return void 0===e&&(e=h.ResoveWay.all),!(e&h.ResoveWay.current&&!1===this.container.forEach(t))&&(!(e&h.ResoveWay.traverse&&this.resolvers.some(function(e){return!!P.isFunction(e.forEach)&&!1===e.forEach(t)}))&&(this.container.parent&&e&h.ResoveWay.bubble?this.container.parent.iterator(t,e):void 0))},e.getClassAnnations=function(){return{name:"ResolverChain",params:{constructor:["container"],next:["resolver"],hasResolver:["resolver"],resolve:["token","resway","providers"],unregister:["token","resway"],getTokenImpl:["token","resway"],has:["token","aliasOrway"],toArray:["resway"],forEach:["callbackfn"],iterator:["callbackfn","resway"]}}},e}();t.ResolverChain=r});t(Ae);Ae.ResolverChainToken,Ae.ResolverChain;var ke=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),l.__exportStar(Ae,t)});t(ke);var be=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.registerCores=function(e){e.registerSingleton(Me.LifeScopeToken,function(){return new Ce.DefaultLifeScope(e)}),e.registerSingleton(Z.CacheManagerToken,function(){return new Ce.CacheManager(e)}),e.registerSingleton(ke.ResolverChainToken,function(){return new ke.ResolverChain(e)}),e.register(W.ProviderMapToken,function(){return new W.ProviderMap(e)}),e.bindProvider(W.ProviderMap,W.ProviderMapToken),e.registerSingleton(W.ProviderParserToken,function(){return new W.ProviderParser(e)}),e.registerSingleton(i.MethodAccessorToken,function(){return new Ce.MethodAccessor(e)}),e.registerSingleton(Ce.MetaAccessorToken,Ce.MetaAccessor);var t=e.get(Me.LifeScopeToken);t.registerDecorator(Ce.Injectable,Ce.CoreActions.bindProvider,Ce.CoreActions.cache),t.registerDecorator(Ce.Component,Ce.CoreActions.bindProvider,Ce.CoreActions.cache,Ce.CoreActions.componentBeforeInit,Ce.CoreActions.componentInit,Ce.CoreActions.componentAfterInit),t.registerDecorator(Ce.Singleton,Ce.CoreActions.bindProvider),t.registerDecorator(Ce.Refs,Ce.CoreActions.bindProvider),t.registerDecorator(Ce.Providers,Ce.CoreActions.bindProvider),t.registerDecorator(Ce.Abstract,Ce.CoreActions.bindProvider,Ce.CoreActions.cache),t.registerDecorator(Ce.AutoWired,Ce.CoreActions.bindParameterType,Ce.CoreActions.bindPropertyType),t.registerDecorator(Ce.Inject,Ce.CoreActions.bindParameterType,Ce.CoreActions.bindPropertyType),t.registerDecorator(Ce.Param,Ce.CoreActions.bindParameterType,Ce.CoreActions.bindPropertyType),t.registerDecorator(Ce.Method,Ce.CoreActions.bindParameterProviders),t.registerDecorator(Ce.Autorun,Ce.CoreActions.autorun,Ce.CoreActions.methodAutorun),t.registerDecorator(Ce.IocExt,Ce.CoreActions.autorun,Ce.CoreActions.componentBeforeInit,Ce.CoreActions.componentInit,Ce.CoreActions.componentAfterInit),e.register(Date,function(){return new Date}),e.register(String,function(){return""}),e.register(Number,function(){return Number.NaN}),e.register(Boolean,function(){}),e.register(Array,function(){return[]})}});t(be);be.registerCores;var xe=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r="___IOC__Singleton___",n=function(){function e(){this.children=[],this.init()}return Object.defineProperty(e.prototype,"size",{get:function(){return this.factories.size},enumerable:!0,configurable:!0}),e.prototype.getRoot=function(){for(var e=this;e.parent;)e=e.parent;return e},e.prototype.getProviderParser=function(){return this.parser||(this.parser=this.resolveValue(W.ProviderParserToken)),this.parser},e.prototype.getBuilder=function(){return this.resolveValue(Te.ContainerBuilderToken)},e.prototype.getResolvers=function(){return this.resolveValue(ke.ResolverChainToken)},e.prototype.has=function(e,t){return this.getResolvers().has(e,t)},e.prototype.hasRegister=function(e){return this.factories.has(this.getTokenKey(e))},e.prototype.get=function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return this.resolve.apply(this,[t?this.getTokenKey(e,t):e].concat(r))},e.prototype.resolve=function(e,t){for(var r,n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];return(r=this.getResolvers()).resolve.apply(r,[e,t].concat(n))},e.prototype.resolveFirst=function(e){for(var t,r=this,n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];return e.some(function(e){return null!==(t=r.resolve.apply(r,[e].concat(n)))}),t},e.prototype.resolveValue=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n=this.getTokenKey(e);return this.hasRegister(n)?this.factories.get(n).apply(void 0,t):null},e.prototype.getService=function(e,t,r,n){for(var o=this,a=[],i=4;i<arguments.length;i++)a[i-4]=arguments[i];if(P.isArray(t)||P.isToken(t)||P.isRefTarget(t)||P.isTypeObject(t)){var s,c=[];(P.isArray(e)?e:[e]).forEach(function(e){c.push(e),P.isClass(e)||c.push(o.getTokenImpl(e))});var u=void 0,p=[];return P.isBoolean(r)?u=r?e:null:P.isToken(r)?u=r:P.isFunction(r)?(s=r,P.isBoolean(n)?u=n?e:null:P.isToken(n)?u=n:n&&p.push(n)):r&&p.unshift(r),u=null===u?null:u||e,p=p.concat(a),this.getRefService.apply(this,[c.map(function(e){return{service:e,isPrivate:!0}}).concat(s?[function(e){return s(e)}]:[],c.map(function(t){return function(e){return new D.InjectReference(t,e)}})),t,u].concat(p))}return this.resolveFirst.apply(this,[P.isArray(e)?e:[e]].concat([t,r,n].concat(a).filter(function(e){return e})))},e.prototype.getRefService=function(t,e,r){for(var n=this,o=[],a=3;a<arguments.length;a++)o[a-3]=arguments[a];var i=null;return(P.isArray(e)?e:[e]).some(function(e){return n.forInRefTarget(e,function(r){return!!D.isInjectReference(r)||!(P.isArray(t)?t:[t]).some(function(e){var t=n.getRefToken(e,r);return(P.isArray(t)?t:[t]).some(function(e){return null!==(i=n.resolveRef.apply(n,[e,r].concat(o)))})})}),null!==i}),!i&&r&&(i=this.resolveFirst.apply(this,[P.isArray(r)?r:[r]].concat(o))),i},e.prototype.getServices=function(e,t,r,n){for(var o=[],a=4;a<arguments.length;a++)o[a-4]=arguments[a];var i=[];return this.iteratorServices.apply(this,[function(e,t,r){for(var n=[],o=3;o<arguments.length;o++)n[o-3]=arguments[o];i.push(t.apply(void 0,n))},e,t,r,n].concat(o)),i},e.prototype.iteratorServices=function(o,e,t,r,n){for(var a,i=this,s=[],c=5;c<arguments.length;c++)s[c-5]=arguments[c];var u,p=h.ResoveWay.all,l=!1;if(P.isToken(e)){var f=P.isClassType(e)?e:this.getTokenImpl(e);u=function(e){return P.lang.isExtendsClass(e,f)}}else P.isFunction(e)&&(u=e);if(P.isNumber(n)?p=n:s.unshift(n),P.isToken(t)||P.isArray(t)){a=!0,P.isBoolean(r)?l=r:P.isNumber(r)?p=r:s.unshift(r);var d=(P.isArray(t)?t:[t]).map(function(e){return P.isClass(e)?e:P.isAbstractClass(e)?e:i.getTokenImpl(e)});this.getResolvers().toArray().some(function(n){return d.some(function(e){var t=new D.InjectReference(W.ProviderMap,e);if(n.has(t,h.ResoveWay.nodes)){var r=n.resolve(t,h.ResoveWay.nodes);return r.keys().some(function(e){return!(!P.isClassType(e)||!u(e))&&!1!==o.apply(void 0,[e,r.get(e),r].concat(s))})}return!1})})}else P.isNumber(t)?p=t:s.unshift(t),a=!1;(!a||a&&l)&&this.iterator(function(e,t,r){if(P.isClassType(e)&&u(e))return o.apply(void 0,[e,t,r].concat(s))},p)},e.prototype.iterator=function(e,t){void 0===t&&(t=h.ResoveWay.all),this.getResolvers().iterator(e,t)},e.prototype.forEach=function(t){var r=this;return!Array.from(this.factories.keys()).some(function(e){return!1===t(e,r.factories.get(e),r)})},e.prototype.getRefToken=function(e,t){return y.isRegistrationClass(e)?new e(t):P.isToken(e)?e:P.isFunction(e)?e(t):e},e.prototype.resolveRef=function(e,t){for(var r,n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];var a=!1;if(P.isToken(e)?r=e:(r=e.service,a=!1!==e.isPrivate),!r)return null;if(P.isClass(t)&&!D.isInjectReference(r)){var i=this.resolve(new D.InjectReference(W.ProviderMap,t));if(i&&i.has(r))return i.resolve.apply(i,[r].concat(n))}return a?null:this.resolve.apply(this,[r].concat(n))},e.prototype.getTokenKey=function(e,t){return t?new y.Registration(e,t).toString():e instanceof y.Registration?e.toString():e},e.prototype.register=function(e,t){return this.registerFactory(e,t),this},e.prototype.registerSingleton=function(e,t){return this.registerFactory(e,t,!0),this},e.prototype.registerValue=function(e,t){var r=this,n=this.getTokenKey(e);return this.getSingleton().set(n,t),this.factories.has(n)||this.factories.set(n,function(){return r.getSingleton().get(n)}),this},e.prototype.bindProvider=function(e,r){var t,n=this,o=this.getTokenKey(e);if(t=P.isToken(r)?function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n.resolve.apply(n,[r].concat(e))}:P.isFunction(r)?function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.apply(void 0,[n].concat(e))}:function(){return r},P.isClass(r))this.has(r)||this.register(r),this.provideTypes.set(o,r);else if(P.isToken(r))for(var a=r;this.provideTypes.has(a)&&!P.isClass(a);)if(a=this.provideTypes.get(a),P.isClass(a)){this.provideTypes.set(o,a);break}return this.factories.set(o,t),this},e.prototype.bindProviders=function(e,t){for(var r,n,o,a=this,i=[],s=2;s<arguments.length;s++)i[s-2]=arguments[s];var c=i;P.isFunction(t)?o=t:t&&c.unshift(t),P.isToken(e)?n=e:e&&(n=null,c.unshift(e));var u=(r=this.getProviderParser()).parse.apply(r,c);if(n){var p=new D.InjectReference(W.ProviderMap,P.isClass(n)?n:this.getTokenImpl(n));this.hasRegister(p)?this.resolveValue(p).copy(u):(this.bindProvider(p,u),o&&o(p))}else u.keys().forEach(function(r){P.isToken(r)&&a.factories.set(r,function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return u.resolve.apply(u,[r].concat(e))})});return this},e.prototype.bindRefProvider=function(e,t,r,n,o){var a=new D.InjectReference(this.getTokenKey(t,n),e);return this.bindProvider(a,r),o&&o(a),this},e.prototype.unregisterValue=function(e){var t=this.getTokenKey(e);return this.hasRegister(t)&&(this.factories.delete(t),this.provideTypes.has(t)&&this.provideTypes.delete(t),P.isClass(t)&&this.clearCache(t)),this},e.prototype.unregister=function(e,t){return this.getResolvers().unregister(e,t),this},e.prototype.clearCache=function(e){this.resolveValue(Z.CacheManagerToken).destroy(e)},e.prototype.getToken=function(e,t){return t?new y.Registration(e,t):e},e.prototype.getTokenProvider=function(e){if(P.isClass(e))return e;var t=this.getTokenKey(e);return this.provideTypes.has(t)?this.provideTypes.get(t):null},e.prototype.getTokenImpl=function(e,t){return this.getResolvers().getTokenImpl(e,t)},e.prototype.forInRefTarget=function(e,i){var t,r,n,s=this;if(P.isToken(e)?(r=e,n=d.RefTagLevel.all):e&&(P.isRefTarget(e)?(r=e.target,n=e.level||d.RefTagLevel.self):P.isTypeObject(e)&&(r=P.lang.getClass(e),n=d.RefTagLevel.all)),P.isToken(r))if(P.isClassType(r)?(t=r,P.isClass(t)&&!this.has(t)&&this.use(t)):t=this.getTokenImpl(r),P.isClassType(r)&&d.RefTagLevel.self!==n){var c=0<(n&d.RefTagLevel.chain),u=0<(n&d.RefTagLevel.providers);P.lang.forInClassChain(t,function(e){var t;if(u){var r=new D.InjectClassProvidesToken(e),n=s.get(r);if(n&&n.provides&&n.provides.length){var o=r.toString(),a=new D.InjectReference(W.ProviderMap,e).toString();t=n.provides.slice(1).filter(function(e){var t=s.getTokenKey(e);return t!==o&&t!==a})}}return!(t=t||[]).concat(e).some(function(e){return!1===i(e)})&&c})}else i(r)},e.prototype.getTokenClassChain=function(e,t){void 0===t&&(t=!0);var r=[];return this.forInRefTarget(e,function(e){return r.push(e),t}),r},e.prototype.getLifeScope=function(){return this.get(Me.LifeScopeToken)},e.prototype.use=function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return(e=this.getBuilder()).syncLoadModule.apply(e,[this].concat(t)),this},e.prototype.loadModule=function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return(e=this.getBuilder()).loadModule.apply(e,[this].concat(t))},e.prototype.invoke=function(e,t,r){for(var n,o=[],a=3;a<arguments.length;a++)o[a-3]=arguments[a];return(n=this.resolveValue(i.MethodAccessorToken)).invoke.apply(n,[e,t,r].concat(o))},e.prototype.syncInvoke=function(e,t,r){for(var n,o=[],a=3;a<arguments.length;a++)o[a-3]=arguments[a];return(n=this.resolveValue(i.MethodAccessorToken)).syncInvoke.apply(n,[e,t,r].concat(o))},e.prototype.createSyncParams=function(e){for(var t,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];return(t=this.resolveValue(i.MethodAccessorToken)).createSyncParams.apply(t,[e].concat(r))},e.prototype.createParams=function(e){for(var t,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];return(t=this.resolveValue(i.MethodAccessorToken)).createParams.apply(t,[e].concat(r))},e.prototype.cacheDecorator=function(e,t){e.has(t.name)||e.set(t.name,t)},e.prototype.init=function(){var e=this;this.factories=new Map,this.provideTypes=new Map,this.bindProvider(h.ContainerToken,function(){return e}),be.registerCores(this)},e.prototype.getSingleton=function(){return this.hasRegister(r)||this.bindProvider(r,new Map),this.resolveValue(r)},e.prototype.registerFactory=function(e,t,r){var n=this.getTokenKey(e);if(!this.factories.has(n)){var o;if(P.isUndefined(t)){if(!P.isString(e)&&!P.isSymbol(e)){var a=e instanceof y.Registration?e.getClass():e;P.isClass(a)&&this.bindTypeFactory(n,a,r)}}else P.isFunction(t)?P.isClass(t)?this.bindTypeFactory(n,t,r):o=this.createCustomFactory(n,t,r):r&&void 0!==t&&(o=this.createCustomFactory(n,function(){return t},r));o&&this.factories.set(n,o)}},e.prototype.createCustomFactory=function(n,o,e){var a=this;return e?function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(a.getSingleton().has(n))return a.getSingleton().get(n);var r=o.apply(void 0,[a].concat(e));return a.getSingleton().set(n,r),r}:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return o.apply(void 0,[a].concat(e))}},e.prototype.bindTypeFactory=function(s,c,u){var p=this;if(Reflect.isExtensible(c)){var l=this.getLifeScope(),f=l.getConstructorParameters(c);u||(u=l.isSingletonType(c));this.factories.set(s,function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];if(u&&p.getSingleton().has(s))return p.getSingleton().get(s);if(t.length<1){var n={tokenKey:s,targetType:c,singleton:u};if(l.execute(n,Ce.CoreActions.cache),n.execResult&&n.execResult instanceof c)return n.execResult}var o=(e=p.getProviderParser()).parse.apply(e,t);l.execute({tokenKey:s,targetType:c,raiseContainer:p,params:f,providers:t,providerMap:o,singleton:u},d.IocState.runtime,Ce.LifeState.beforeCreateArgs);var a=p.createSyncParams(f,o);l.routeExecute({tokenKey:s,targetType:c,raiseContainer:p,args:a,params:f,providers:t,providerMap:o,singleton:u},d.IocState.runtime,Ce.LifeState.beforeConstructor);var i=new(c.bind.apply(c,[void 0].concat(a)));return l.routeExecute({tokenKey:s,target:i,targetType:c,raiseContainer:p,args:a,params:f,providers:t,providerMap:o,singleton:u},d.IocState.runtime,Ce.LifeState.afterConstructor),l.execute({tokenKey:s,target:i,targetType:c,raiseContainer:p,args:a,params:f,providers:t,providerMap:o,singleton:u},d.IocState.runtime,Ce.LifeState.onInit),l.routeExecute({tokenKey:s,target:i,targetType:c,raiseContainer:p,args:a,params:f,providers:t,providerMap:o,singleton:u},d.IocState.runtime,Ce.LifeState.AfterInit),l.execute({tokenKey:s,target:i,targetType:c,raiseContainer:p},Ce.CoreActions.cache),i}),l.routeExecute({tokenKey:s,targetType:c,raiseContainer:this},d.IocState.design)}},e.getClassAnnations=function(){return{name:"Container",params:{constructor:[],getRoot:[],getProviderParser:[],getBuilder:[],getResolvers:[],has:["token","aliasOrway"],hasRegister:["key"],get:["token","alias","providers"],resolve:["token","resway","providers"],resolveFirst:["tokens","providers"],resolveValue:["token","providers"],getService:["token","target","toRefToken","defaultToken","providers"],getRefService:["refToken","target","defaultToken","providers"],getServices:["token","target","both","resway","providers"],iteratorServices:["express","token","target","both","resway","providers"],iterator:["callbackfn","resway"],forEach:["callbackfn"],getRefToken:["ref","tk"],resolveRef:["refToken","target","providers"],getTokenKey:["token","alias"],register:["token","value"],registerSingleton:["token","value"],registerValue:["token","value"],bindProvider:["provide","provider"],bindProviders:["target","onceBinded","providers"],bindRefProvider:["target","provide","provider","alias","onceBinded"],unregisterValue:["token"],unregister:["token","resway"],clearCache:["targetType"],getToken:["token","alias"],getTokenProvider:["token"],getTokenImpl:["token","resway"],forInRefTarget:["target","express"],getTokenClassChain:["token","chain"],getLifeScope:[],use:["modules"],loadModule:["modules"],invoke:["target","propertyKey","instance","providers"],syncInvoke:["target","propertyKey","instance","providers"],createSyncParams:["params","providers"],createParams:["params","providers"],cacheDecorator:["map","action"],init:[],getSingleton:[],registerFactory:["token","value","singleton"],createCustomFactory:["key","factory","singleton"],bindTypeFactory:["key","ClassT","singleton"]}}},e}();t.Container=n});t(xe);xe.Container;var je=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ModuleLoaderToken=new a.InjectToken("DI_ModuleLoader")});t(je);je.ModuleLoaderToken;var Se=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.prototype.getLoader=function(){return this._loader||(this._loader=this.createLoader()),this._loader},e.prototype.load=function(e){var t=this;return e.length?Promise.all(e.map(function(e){return P.isString(e)?t.isFile(e)?t.loadFile(e):t.loadModule(e):P.isObject(e)&&(e.modules||e.files)?t.loadPathModule(e):e?[e]:[]})).then(function(e){var t=[];return e.forEach(function(e){t=t.concat(e)}),t}):Promise.resolve([])},e.prototype.loadTypes=function(r){return l.__awaiter(this,void 0,void 0,function(){var t;return l.__generator(this,function(e){switch(e.label){case 0:return[4,this.load(r)];case 1:return t=e.sent(),[2,this.getTypes(t)]}})})},e.prototype.getTypes=function(e){var r=this,n=[];return e.forEach(function(e){var t=r.getContentTypes(e);n.push(t)}),n},e.prototype.loadFile=function(e,t){var r=this.getLoader();return(P.isArray(e)?Promise.all(e.map(function(e){return r(e)})).then(function(e){var t=[];return e.forEach(function(e){t=t.concat(e)}),t}):r(e)).then(function(e){return e.filter(function(e){return!!e})})},e.prototype.isFile=function(e){return e&&/\/((\w|%|\.))+\.\w+$/.test(e.replace(/\\\\/gi,"/"))},e.prototype.loadModule=function(e){return this.getLoader()(e).then(function(e){return e.filter(function(e){return!!e})})},e.prototype.loadPathModule=function(n){return l.__awaiter(this,void 0,void 0,function(){var t,r=this;return l.__generator(this,function(e){switch(e.label){case 0:return t=[],n.files?[4,this.loadFile(n.files,n.basePath).then(function(e){return e.forEach(function(e){t=t.concat(e)}),t})]:[3,2];case 1:e.sent(),e.label=2;case 2:return n.modules?[4,Promise.all(n.modules.map(function(e){return P.isString(e)?r.loadModule(e):e})).then(function(e){return t=t.concat(e)})]:[3,4];case 3:e.sent(),e.label=4;case 4:return[2,t]}})})},e.prototype.createLoader=function(){if(void 0!==n)return function(e){return new Promise(function(e,t){n()})};throw new Error("has not module loader")},e.prototype.getContentTypes=function(e){var t=[];if(P.isClass(e))t.push(e);else if(e){var r=e.exports?e.exports:e;for(var n in r){var o=r[n];P.isClass(o)&&t.push(o)}}return t},e.getClassAnnations=function(){return{name:"DefaultModuleLoader",params:{constructor:[],getLoader:[],load:["modules"],loadTypes:["modules"],getTypes:["modules"],loadFile:["files","basePath"],isFile:["str"],loadModule:["moduleName"],loadPathModule:["pmd"],createLoader:[],getContentTypes:["regModule"]}}},e}();t.DefaultModuleLoader=r});t(Se);Se.DefaultModuleLoader;var Ie=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(t){function e(e){return t.call(this,e,"ModuleValidate")||this}return l.__extends(e,t),e.getClassAnnations=function(){return{name:"InjectModuleValidateToken",params:{constructor:["decorator"]}}},e}(D.RefRegistration);t.InjectModuleValidateToken=r,t.ModuleValidateToken=new r("")});t(Ie);Ie.InjectModuleValidateToken,Ie.ModuleValidateToken;var Oe=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.prototype.valid=function(t){if(!P.isClass(t))return!1;var e=this.getDecorator();return P.isString(e)?Ce.hasOwnClassMetadata(e,t):!P.isArray(e)||e.some(function(e){return Ce.hasOwnClassMetadata(e,t)})},e.prototype.getDecorator=function(){return null},e.getClassAnnations=function(){return{name:"ModuelValidate",params:{constructor:[],valid:["type"],getDecorator:[]}}},e}();t.ModuelValidate=r,t.IocExtModuleValidateToken=new Ie.InjectModuleValidateToken(Ce.IocExt.toString());var n=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return l.__extends(t,e),t.prototype.getDecorator=function(){return Ce.IocExt.toString()},t.getClassAnnations=function(){return{name:"IocExtModuleValidate",params:{getDecorator:[]}}},t}(r);t.IocExtModuleValidate=n});t(Oe);Oe.ModuelValidate,Oe.IocExtModuleValidateToken,Oe.IocExtModuleValidate;var we=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(t){function e(e){return t.call(this,"DI_ModuleInjector",e)||this}return l.__extends(e,t),e.getClassAnnations=function(){return{name:"InjectModuleInjectorToken",params:{constructor:["desc"]}}},e}(y.Registration);t.InjectModuleInjectorToken=r,t.ModuleInjectorToken=new r("")});t(we);we.InjectModuleInjectorToken,we.ModuleInjectorToken;var Re=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){this.validate=e,this.skipNext=t}return e.prototype.inject=function(o,a){return l.__awaiter(this,void 0,void 0,function(){var t,r,n=this;return l.__generator(this,function(e){switch(e.label){case 0:return(t=(a||[]).filter(function(e){return n.valid(o,e)})).length?[4,P.PromiseUtil.step(t.map(function(e){return function(){return n.setup(o,e)}}))]:[3,2];case 1:e.sent(),e.label=2;case 2:return r=this.getNext(a,t),[2,{injected:t,next:r}]}})})},e.prototype.syncInject=function(t,e){var r=this,n=(e||[]).filter(function(e){return r.valid(t,e)});return n.length&&n.forEach(function(e){r.syncSetup(t,e)}),{injected:n,next:this.getNext(e,n)}},e.prototype.valid=function(e,t){return!this.validate||this.validate.valid(t)},e.prototype.getNext=function(e,t){return 0===t.length?e:this.skipNext?null:t.length===e.length?null:e.filter(function(e){return t.indexOf(e)<0})},e.prototype.setup=function(t,r){return l.__awaiter(this,void 0,void 0,function(){return l.__generator(this,function(e){return t.register(r),[2]})})},e.prototype.syncSetup=function(e,t){e.register(t)},e.getClassAnnations=function(){return{name:"ModuleInjector",params:{constructor:["validate","skipNext"],inject:["container","modules"],syncInject:["container","modules"],valid:["container","type"],getNext:["all","filtered"],setup:["container","type"],syncSetup:["container","type"]}}},e=l.__decorate([Ce.Injectable(we.ModuleInjectorToken),l.__param(0,Ce.Inject(Ie.ModuleValidateToken)),l.__metadata("design:paramtypes",[Object,Boolean])],e)}();t.ModuleInjector=r});t(Re);Re.ModuleInjector;var De=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ModuleInjectorChainToken=new a.InjectToken("DI_ModuleInjectorChain")});t(De);De.ModuleInjectorChainToken;var Ee=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){this._injectors=[]}return Object.defineProperty(e.prototype,"injectors",{get:function(){return this._injectors},enumerable:!0,configurable:!0}),e.prototype.first=function(e){return this.isInjector(e)&&this._injectors.unshift(e),this},e.prototype.next=function(e){return this.isInjector(e)&&this._injectors.push(e),this},e.prototype.isInjector=function(e){return e instanceof Re.ModuleInjector},e.prototype.inject=function(i,r){return l.__awaiter(this,void 0,void 0,function(){var a,t=this;return l.__generator(this,function(e){switch(e.label){case 0:return a=[],[4,P.PromiseUtil.runInChain(this.injectors.map(function(o){return function(r,n){return l.__awaiter(t,void 0,void 0,function(){var t;return l.__generator(this,function(e){switch(e.label){case 0:return[4,o.inject(i,r)];case 1:return(t=e.sent()).injected&&t.injected.length&&(a=a.concat(t.injected)),t.next&&0<t.next.length?[2,n()]:[2]}})})}}),r)];case 1:return e.sent(),[2,a]}})})},e.prototype.syncInject=function(r,n){var o=[],a=!1;return this.injectors.some(function(e){if(e instanceof Re.ModuleInjector){var t=e.syncInject(r,n);o=o.concat(t.injected),a=!t.next||t.next.length<1}return a}),o},e.getClassAnnations=function(){return{name:"ModuleInjectorChain",params:{constructor:[],first:["injector"],next:["injector"],isInjector:["injector"],inject:["container","modules"],syncInject:["container","modules"]}}},e}();t.ModuleInjectorChain=r});t(Ee);Ee.ModuleInjectorChain;var Ne=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),l.__exportStar(je,t),l.__exportStar(Se,t),l.__exportStar(Ie,t),l.__exportStar(Oe,t),l.__exportStar(we,t),l.__exportStar(Re,t),l.__exportStar(De,t),l.__exportStar(Ee,t)});t(Ne);var Fe=r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this._loader=e}return Object.defineProperty(e.prototype,"loader",{get:function(){return this._loader||(this._loader=new Ne.DefaultModuleLoader),this._loader},enumerable:!0,configurable:!0}),e.prototype.create=function(){var e=this,t=new xe.Container;return t.bindProvider(Te.ContainerBuilderToken,function(){return e}),t.bindProvider(Ne.ModuleLoaderToken,function(){return e.loader}),t},e.prototype.build=function(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];return l.__awaiter(this,void 0,void 0,function(){var t;return l.__generator(this,function(e){switch(e.label){case 0:return t=this.create(),r.length?[4,this.loadModule.apply(this,[t].concat(r))]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2,t]}})})},e.prototype.loadModule=function(i){for(var r=[],e=1;e<arguments.length;e++)r[e-1]=arguments[e];return l.__awaiter(this,void 0,void 0,function(){var t,n,o,a=this;return l.__generator(this,function(e){switch(e.label){case 0:return[4,this.loader.loadTypes(r)];case 1:return t=e.sent(),n=[],t&&t.length?(o=this.getInjectorChain(i),[4,P.PromiseUtil.step(t.map(function(r){return function(){return l.__awaiter(a,void 0,void 0,function(){var t;return l.__generator(this,function(e){switch(e.label){case 0:return[4,o.inject(i,r)];case 1:return t=e.sent(),n=n.concat(t),[2]}})})}}))]):[3,3];case 2:e.sent(),e.label=3;case 3:return[2,n]}})})},e.prototype.syncBuild=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=this.create();return e.length&&this.syncLoadModule.apply(this,[r].concat(e)),r},e.prototype.syncLoadModule=function(r){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];var n=this.loader.getTypes(e),o=[];if(n&&n.length){var a=this.getInjectorChain(r);n.forEach(function(e){var t=a.syncInject(r,e);o=o.concat(t)})}return o},e.prototype.getInjectorChain=function(e){return e.has(Ne.ModuleInjectorChainToken)||e.register(Ne.ModuleInjector).bindProvider(Ne.ModuleValidateToken,new Ne.ModuelValidate).bindProvider(Ne.IocExtModuleValidateToken,new Ne.IocExtModuleValidate).bindProvider(Ne.ModuleInjectorChainToken,(new Ne.ModuleInjectorChain).next(e.resolve(Ne.ModuleInjectorToken,{provide:Ne.ModuleValidateToken,useValue:e.get(Ne.IocExtModuleValidateToken)},{skipNext:!0})).next(e.resolve(Ne.ModuleInjectorToken))),e.get(Ne.ModuleInjectorChainToken)},e.getClassAnnations=function(){return{name:"ContainerBuilder",params:{constructor:["loader"],create:[],build:["modules"],loadModule:["container","modules"],syncBuild:["modules"],syncLoadModule:["container","modules"],getInjectorChain:["container"]}}},e}();t.ContainerBuilder=r});t(Fe);Fe.ContainerBuilder;return t(r(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),l.__exportStar(h,t),l.__exportStar(xe,t),l.__exportStar(d,t),l.__exportStar(y,t),l.__exportStar(D,t),l.__exportStar(a,t),l.__exportStar(Te,t),l.__exportStar(i,t),l.__exportStar(Z,t),l.__exportStar(Me,t),l.__exportStar(Fe,t),l.__exportStar(P,t),l.__exportStar(f,t),l.__exportStar(Ce,t),l.__exportStar(Ne,t),l.__exportStar(W,t),l.__exportStar(ke,t)}))});
//# sourceMappingURL=sourcemaps/core.umd.min.js.map
